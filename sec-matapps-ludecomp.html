<!DOCTYPE html>
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<html lang="en-US">
<head xmlns:og="http://ogp.me/ns#" xmlns:book="https://ogp.me/ns/book#">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>PA=LU Decomposition</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:type" content="book">
<meta property="book:title" content="AAM: Algorithms for Applied Mathematics">
<meta property="book:author" content="Stephen J. Graves">
<script>var runestoneMathReady = new Promise((resolve) => window.rsMathReady = resolve);
window.MathJax = {
  tex: {
    inlineMath: [['\\(','\\)']],
    tags: "none",
    tagSide: "right",
    tagIndent: ".8em",
    packages: {'[+]': ['base', 'extpfeil', 'ams', 'amscd', 'color', 'newcommand', 'knowl']}
  },
  options: {
    ignoreHtmlClass: "tex2jax_ignore|ignore-math",
    processHtmlClass: "process-math",
  },
  chtml: {
    scale: 0.98,
    mtextInheritFont: true
  },
  loader: {
    load: ['input/asciimath', '[tex]/extpfeil', '[tex]/amscd', '[tex]/color', '[tex]/newcommand', '[pretext]/mathjaxknowl3.js'],
    paths: {pretext: "https://pretextbook.org/js/lib"},
  },
  startup: {
    pageReady() {
      return MathJax.startup.defaultPageReady().then(function () {
      console.log("in ready function");
      rsMathReady();
      }
    )}
  },
};
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/themes/prism.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/components/prism-core.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/autoloader/prism-autoloader.min.js"></script><script src="https://unpkg.com/lunr/lunr.js"></script><script src="lunr-pretext-search-index.js"></script><script src="https://pretextbook.org/js/0.2/pretext_search.js"></script><link href="https://pretextbook.org/css/0.6/pretext_search.css" rel="stylesheet" type="text/css">
<script>js_version = 0.2</script><script src="https://pretextbook.org/js/lib/jquery.min.js"></script><script src="https://pretextbook.org/js/lib/jquery.sticky.js"></script><script src="https://pretextbook.org/js/lib/jquery.espy.min.js"></script><script src="https://pretextbook.org/js/0.2/pretext.js"></script><script>miniversion=0.1</script><script src="https://pretextbook.org/js/0.2/pretext_add_on.js?x=1"></script><script src="https://pretextbook.org/js/0.2/user_preferences.js"></script><script src="https://pretextbook.org/js/lib/knowl.js"></script><!--knowl.js code controls Sage Cells within knowls--><script>sagecellEvalName='Evaluate (Sage)';
</script><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@400;700&amp;family=Noto+Serif:ital,wght@0,400;0,700;1,400;1,700&amp;family=Tinos:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet">
<link href="https://fonts.cdnfonts.com/css/dejavu-serif" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Roboto+Serif:opsz,wdth,wght@8..144,50..150,100..900&amp;display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Open+Sans:wdth,wght@75..100,300..800&amp;display=swap" rel="stylesheet">
<link href="https://pretextbook.org/css/0.6/pretext.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.6/pretext_add_on.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.6/shell_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.6/banner_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.6/navbar_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.6/toc_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.6/knowls_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.6/style_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.6/colors_pastel_blue_orange.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.6/setcolors.css" rel="stylesheet" type="text/css">
</head>
<body class="pretext book ignore-math">
<a class="assistive" href="#ptx-content">Skip to main content</a><header id="ptx-masthead"><div class="ptx-banner">
<a id="logo-link" href=""></a><div class="title-container">
<h1 class="heading"><a href="AAM.html"><span class="title">AAM: Algorithms for Applied Mathematics</span></a></h1>
<p class="byline">Stephen J. Graves</p>
</div>
<div id="searchresultsplaceholder" style="display: none">
<button id="closesearchresults" onclick="document.getElementById('searchresultsplaceholder').style.display = 'none'; return false;">x</button><h2>Search Results: <span id="searchterms"></span>
</h2>
<div id="searchempty"><span>No results.</span></div>
<ol id="searchresults"></ol>
</div>
</div></header><nav id="ptx-navbar" class="navbar"><button class="toc-toggle button" aria-label="Show or hide table of contents"><span class="icon">‚ò∞</span><span class="name">Contents</span></button><button id="user-preferences-button" class="user-preferences-button button" title="Modify user preferences"><span id="theavatarbutton" class="name">You!</span><div id="preferences_menu_holder" class="hidden"><ol id="preferences_menu" style="font-family: 'Roboto Serif', serif;">
<li data-env="avatar" tabindex="-1">Choose avatar<div class="wrap_to_submenu"><span class="to_submenu">‚ñª</span></div>
<ol class="hidden avatar">
<li data-val="You!" tabindex="-1">
<span id="theYou!" class="avatarcheck">‚úîÔ∏è</span>You!</li>
<li data-val="üò∫" tabindex="-1">
<span id="theüò∫" class="avatarcheck"></span>üò∫</li>
<li data-val="üë§" tabindex="-1">
<span id="theüë§" class="avatarcheck"></span>üë§</li>
<li data-val="üëΩ" tabindex="-1">
<span id="theüëΩ" class="avatarcheck"></span>üëΩ</li>
<li data-val="üê∂" tabindex="-1">
<span id="theüê∂" class="avatarcheck"></span>üê∂</li>
<li data-val="üêº" tabindex="-1">
<span id="theüêº" class="avatarcheck"></span>üêº</li>
<li data-val="üåà" tabindex="-1">
<span id="theüåà" class="avatarcheck"></span>üåà</li>
</ol>
</li>
<li data-env="fontfamily" tabindex="-1">Font family<div class="wrap_to_submenu"><span class="to_submenu">‚ñª</span></div>
<ol class="hidden fontfamily">
<li data-val="face" data-change="OS" tabindex="-1" style="font-family: 'Open Sans'">
<span id="theOS" class="ffcheck">‚úîÔ∏è</span><span class="name">Open Sans</span><span class="sample">AaBbCc 123 PreTeXt</span>
</li>
<li data-val="face" data-change="RS" tabindex="-1" style="font-family: 'Roboto Serif'">
<span id="theRS" class="ffcheck"></span><span class="name">Roboto Serif</span><span class="sample">AaBbCc 123 PreTeXt</span>
</li>
</ol>
</li>
<li data-env="font" tabindex="-1">Adjust font<div class="wrap_to_submenu"><span class="to_submenu">‚ñª</span></div>
<ol class="hidden fonts">
<li>Size</li>
<li><span id="thesize">12</span></li>
<li data-val="size" data-change="-1" tabindex="-1" style="font-size: 80%">Smaller</li>
<li data-val="size" data-change="1" tabindex="-1" style="font-size: 110%">Larger</li>
<li>Width</li>
<li><span id="thewdth">100</span></li>
<li data-val="wdth" data-change="-5" tabindex="-1" style="font-variation-settings: 'wdth' 60">narrower</li>
<li data-val="wdth" data-change="5" tabindex="-1" style="font-variation-settings: 'wdth' 150">wider</li>
<li>Weight</li>
<li><span id="thewght">400</span></li>
<li data-val="wght" data-change="-50" tabindex="-1" style="font-weight: 200">thinner</li>
<li data-val="wght" data-change="50" tabindex="-1" style="font-weight: 700">heavier</li>
<li>Letter spacing</li>
<li>
<span id="thelspace">0</span><span class="byunits">/200</span>
</li>
<li data-val="lspace" data-change="-1" tabindex="-1">closer</li>
<li data-val="lspace" data-change="1" tabindex="-1">f a r t h e r</li>
<li>Word spacing</li>
<li>
<span id="thewspace">0</span><span class="byunits">/50</span>
</li>
<li data-val="wspace" data-change="-1" tabindex="-1">smaller‚ÄÖgap‚ÄÉ</li>
<li data-val="wspace" data-change="1" tabindex="-1">larger‚ÄÉgap</li>
<li>Line Spacing</li>
<li>
<span id="theheight">135</span><span class="byunits">/100</span>
</li>
<li data-val="height" data-change="-5" tabindex="-1" style="line-height: 1">closer<br>together</li>
<li data-val="height" data-change="5" tabindex="-1" style="line-height: 1.75">further<br>apart</li>
</ol>
</li>
<li data-env="atmosphere" tabindex="-1">Light/dark mode<div class="wrap_to_submenu"><span class="to_submenu">‚ñª</span></div>
<ol class="hidden atmosphere">
<li data-val="default" tabindex="-1">
<span id="thedefault" class="atmospherecheck">‚úîÔ∏è</span>default</li>
<li data-val="pastel" tabindex="-1">
<span id="thepastel" class="atmospherecheck"></span>pastel</li>
<li data-val="darktwilight" tabindex="-1">
<span id="thedarktwilight" class="atmospherecheck"></span>twilight</li>
<li data-val="dark" tabindex="-1">
<span id="thedark" class="atmospherecheck"></span>dark</li>
<li data-val="darkmidnight" tabindex="-1">
<span id="thedarkmidnight" class="atmospherecheck"></span>midnight</li>
</ol>
</li>
<li data-env="ruler" tabindex="-1">Reading ruler<div class="wrap_to_submenu"><span class="to_submenu">‚ñª</span></div>
<ol class="hidden ruler">
<li data-val="none" tabindex="-1">
<span id="thenone" class="rulercheck">‚úîÔ∏è</span>none</li>
<li data-val="underline" tabindex="-1">
<span id="theunderline" class="rulercheck"></span>underline</li>
<li data-val="lunderline" tabindex="-1">
<span id="thelunderline" class="rulercheck"></span>L-underline</li>
<li data-val="greybar" tabindex="-1">
<span id="thegreybar" class="rulercheck"></span>grey bar</li>
<li data-val="lightbox" tabindex="-1">
<span id="thelightbox" class="rulercheck"></span>light box</li>
<li data-val="sunrise" tabindex="-1">
<span id="thesunrise" class="rulercheck"></span>sunrise</li>
<li data-val="sunriseunderline" tabindex="-1">
<span id="thesunriseunderline" class="rulercheck"></span>sunrise underline</li>
<li class="moveQ">Motion by:</li>
<li data-val="mouse" tabindex="-1">
<span id="themouse" class="motioncheck">‚úîÔ∏è</span>follow the mouse</li>
<li data-val="arrow" tabindex="-1">
<span id="thearrow" class="motioncheck"></span>up/down arrows - not yet</li>
<li data-val="eye" tabindex="-1">
<span id="theeye" class="motioncheck"></span>eye tracking - not yet</li>
</ol>
</li>
</ol></div></button><span class="treebuttons"><a class="previous-button button" href="sec-matapps-gje_proj.html" title="Previous"><span class="icon">&lt;</span><span class="name">Prev</span></a><a class="up-button button" href="ch-matrix-apps.html" title="Up"><span class="icon">^</span><span class="name">Up</span></a><a class="next-button button" href="ch-gtalgos.html" title="Next"><span class="name">Next</span><span class="icon">&gt;</span></a></span><div class="searchbox"><div class="searchwidget">
<input id="ptxsearch" type="text" name="terms" placeholder="Search" onchange="doSearch()"><button id="searchbutton" type="button" onclick="doSearch()">üîç</button>
</div></div></nav><div id="latex-macros" class="hidden-content process-math" style="display:none"><span class="process-math">\(\usepackage{mathtools}
\DeclareMathOperator{\fixedset}{fix}
\DeclareMathOperator{\support}{supp}
\DeclareMathOperator{\lcm}{lcm}

\newcommand{\set}[1]{\left\{#1\right\}}
\newcommand{\upto}[1]{\set{0,1,\dotsc,#1-1}}
\newcommand{\seq}[1]{\left(#1\right)}
\newcommand{\abs}[1]{\left|#1\right|}
\newcommand{\floor}[1]{\left\lfloor#1\right\rfloor}
\newcommand{\ceil}[1]{\left\lceil#1\right\rceil}
\newcommand{\after}{\circ}
\newcommand{\sym}[1]{\mathcal{S}_{#1}}
\newcommand{\fix}[1]{\fixedset{#1}}
\newcommand{\supp}[1]{\support{#1}}
\newcommand{\xto}[1]{\xrightarrow{#1}}
\newcommand{\arr}[1]{\overrightarrow{#1}}

\newcommand{\rem}{\%}
\newcommand{\divides}{\mid}
\newcommand{\Nats}{\mathbb{N}}
\newcommand{\Ints}{\mathbb{Z}}
\newcommand{\Zp}{\Ints^+}
\newcommand{\Rats}{\mathbb{Q}}
\newcommand{\Reals}{\mathbb{R}}
\newcommand{\Comps}{\mathbb{C}}
\newcommand{\Mats}[1]{\mathbb{M}_{#1}}
\renewcommand{\vec}[1]{\mathbf{#1}}
\newcommand{\cvec}[1]{\begin{bmatrix}#1\end{bmatrix}}
\newcommand{\vv}{\vec{v}}
\newcommand{\CV}[1]{\Comps^{#1}}
\newcommand{\entry}[2]{\left[#1\right]_{#2}}
\newcommand{\hip}[2]{\left\langle#1,#2\right\rangle}
\newcommand{\conj}[1]{\overline{#1}}

\newcommand{\dist}[3]{d_{#1}\left(#2,#3\right)}
\newcommand{\norm}[1]{\left\|#1\right\|}
\DeclareMathOperator{\spn}{span}
\newcommand{\spanset}[1]{\spn #1}
\DeclareMathOperator{\Aut}{Aut}
\newcommand{\rswap}[2]{R_{#1}\leftrightarrow R_{#2}}
\newcommand{\rscale}[2]{\left(#1\right) R_{#2}}
\newcommand{\relim}[3]{\left(#1\right) R_{#2}+R_{#3}}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\definecolor{fillinmathshade}{gray}{0.9}
\newcommand{\fillinmath}[1]{\mathchoice{\colorbox{fillinmathshade}{$\displaystyle     \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\textstyle        \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptstyle      \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptscriptstyle\phantom{\,#1\,}$}}}
\)</span></div>
<div class="ptx-page">
<div id="ptx-sidebar"><nav id="ptx-toc" class="depth2"><ul class="structural">
<li>
<div class="toc-item"><a href="frontmatter.html" class="internal"><span class="title">Front Matter</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="AAM-fm-col.html" class="internal"><span class="title">Colophon</span></a></div></li>
<li><div class="toc-item"><a href="AAM-fm-ack.html" class="internal"><span class="title">Acknowledgements</span></a></div></li>
</ul>
</li>
<li>
<div class="toc-item"><a href="ch-intro.html" class="internal"><span class="codenumber">1</span> <span class="title">Welcome!</span></a></div>
<ul class="structural">
<li>
<div class="toc-item"><a href="sec-intro-mst.html" class="internal"><span class="codenumber">1.1</span> <span class="title">Connecting a network</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="sec-intro-mst.html#subsec-intro-mst-example" class="internal"><span class="codenumber">1.1.1</span> <span class="title">Working from an example</span></a></div></li>
<li><div class="toc-item"><a href="sec-intro-mst.html#subsec-intro-mst-algorithm" class="internal"><span class="codenumber">1.1.2</span> <span class="title">Algorithm</span></a></div></li>
</ul>
</li>
<li><div class="toc-item"><a href="sec-intro-kidrsa.html" class="internal"><span class="codenumber">1.2</span> <span class="title">Familiarity with Python</span></a></div></li>
</ul>
</li>
<li>
<div class="toc-item"><a href="ch-perms.html" class="internal"><span class="codenumber">2</span> <span class="title">Permutations</span></a></div>
<ul class="structural">
<li>
<div class="toc-item"><a href="sec-perms-def.html" class="internal"><span class="codenumber">2.1</span> <span class="title">Mathematical permutations</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="sec-perms-def.html#sub-perms-def-linenotations" class="internal"><span class="codenumber">2.1.1</span> <span class="title">One-line and two-line notations</span></a></div></li>
<li>
<div class="toc-item"><a href="sec-perms-def.html#sub-perms-def-groups" class="internal"><span class="codenumber">2.1.2</span> <span class="title">Permutation groups</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="sec-perms-def.html#subsub-perms-def-groups-products" class="internal"><span class="codenumber">2.1.2.1</span> <span class="title">Calculating permutation products</span></a></div></li>
<li><div class="toc-item"><a href="sec-perms-def.html#subsub-perms-def-groups-multprops" class="internal"><span class="codenumber">2.1.2.2</span> <span class="title">Properties of permutation multiplication</span></a></div></li>
<li><div class="toc-item"><a href="sec-perms-def.html#subsub-perms-def-groups-absalg" class="internal"><span class="codenumber">2.1.2.3</span> <span class="title">Abstract algebra and permutation groups</span></a></div></li>
</ul>
</li>
<li><div class="toc-item"><a href="sec-perms-def.html#sub-perms-def-cycles" class="internal"><span class="codenumber">2.1.3</span> <span class="title">Cycles and disjoint cycle decomposition</span></a></div></li>
</ul>
</li>
<li>
<div class="toc-item"><a href="sec-perms-oop.html" class="internal"><span class="codenumber">2.2</span> <span class="title">Permutations in Python</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="sec-perms-oop.html#sec-perms-oop_classes" class="internal"><span class="codenumber">2.2.1</span> <span class="title">Classes</span></a></div></li>
<li><div class="toc-item"><a href="sec-perms-oop.html#sub-perms-oop_instantiation" class="internal"><span class="codenumber">2.2.2</span> <span class="title">Creating new objects</span></a></div></li>
<li><div class="toc-item"><a href="sec-perms-oop.html#sub-perms-oop_validation" class="internal"><span class="codenumber">2.2.3</span> <span class="title">Input validation</span></a></div></li>
<li><div class="toc-item"><a href="sec-perms-oop.html#sub-perms-oop_adding_methods" class="internal"><span class="codenumber">2.2.4</span> <span class="title">Additional methods</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li>
<div class="toc-item"><a href="ch-crypto.html" class="internal"><span class="codenumber">3</span> <span class="title">Simple Cryptography</span></a></div>
<ul class="structural">
<li>
<div class="toc-item"><a href="sec-crypto-subst.html" class="internal"><span class="codenumber">3.1</span> <span class="title">Simple substitution ciphers</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="sec-crypto-subst.html#sub-crypto-subst-simple" class="internal"><span class="codenumber">3.1.1</span> <span class="title">Monoalphabetic substitution</span></a></div></li>
<li><div class="toc-item"><a href="sec-crypto-subst.html#sub-crypto-subst-freqanalysis" class="internal"><span class="codenumber">3.1.2</span> <span class="title">Frequency analysis</span></a></div></li>
</ul>
</li>
<li>
<div class="toc-item"><a href="sec-crypto-classic.html" class="internal"><span class="codenumber">3.2</span> <span class="title">Other classical ciphers</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="sec-crypto-classic.html#sub-crypto-classic-digraphs" class="internal"><span class="codenumber">3.2.1</span> <span class="title">Increasing the alphabet: Playfair's cipher</span></a></div></li>
<li>
<div class="toc-item"><a href="sec-crypto-classic.html#sub-crypto-classic-poly" class="internal"><span class="codenumber">3.2.2</span> <span class="title">Polyalphabetic substitution</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="sec-crypto-classic.html#ssub-crypto-classic-tabularecta" class="internal"><span class="codenumber">3.2.2.1</span> <span class="title">The tabula recta</span></a></div></li>
<li><div class="toc-item"><a href="sec-crypto-classic.html#ssub-crypto-classic-vigenere" class="internal"><span class="codenumber">3.2.2.2</span> <span class="title">Vigen√®re ciphers and the index of coincidence</span></a></div></li>
<li><div class="toc-item"><a href="sec-crypto-classic.html#ssub-crypto-classic-onetimepad" class="internal"><span class="codenumber">3.2.2.3</span> <span class="title">One-time pads</span></a></div></li>
</ul>
</li>
<li><div class="toc-item"><a href="sec-crypto-classic.html#sub-crypto-classic-enigma" class="internal"><span class="codenumber">3.2.3</span> <span class="title">The Enigma cipher</span></a></div></li>
</ul>
</li>
<li>
<div class="toc-item"><a href="sec-crypto-proj.html" class="internal"><span class="codenumber">3.3</span> <span class="title">Crypto in Python</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="sec-crypto-proj.html#sub-crypto-proj-manual_decryption" class="internal"><span class="codenumber">3.3.1</span> <span class="title">Demonstrating understanding</span></a></div></li>
<li><div class="toc-item"><a href="sec-crypto-proj.html#sub-crypto-proj-implementations" class="internal"><span class="codenumber">3.3.2</span> <span class="title">Implementing cryptography</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li>
<div class="toc-item"><a href="ch-linalg.html" class="internal"><span class="codenumber">4</span> <span class="title">Linear Algebra</span></a></div>
<ul class="structural">
<li>
<div class="toc-item"><a href="sec-linalg-vectors.html" class="internal"><span class="codenumber">4.1</span> <span class="title">Vectors</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="sec-linalg-vectors.html#sub-linalg-vectors-axioms" class="internal"><span class="codenumber">4.1.1</span> <span class="title">Vector space axioms</span></a></div></li>
<li><div class="toc-item"><a href="sec-linalg-vectors.html#sub-linalg-vectors-colvecs" class="internal"><span class="codenumber">4.1.2</span> <span class="title">Column vectors</span></a></div></li>
<li><div class="toc-item"><a href="sec-linalg-vectors.html#sub-linalg-vectors-lintrans" class="internal"><span class="codenumber">4.1.3</span> <span class="title">Linear transformations</span></a></div></li>
<li><div class="toc-item"><a href="sec-linalg-vectors.html#sub-linalg-vectors-inner_prods" class="internal"><span class="codenumber">4.1.4</span> <span class="title">Inner product spaces</span></a></div></li>
</ul>
</li>
<li>
<div class="toc-item"><a href="sec-linalg-vecproj.html" class="internal"><span class="codenumber">4.2</span> <span class="title">Vectors in Python</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="sec-linalg-vecproj.html#sub-vecproj-init_and_repr" class="internal"><span class="codenumber">4.2.1</span> <span class="title">Getting started with initialization and representation</span></a></div></li>
<li><div class="toc-item"><a href="sec-linalg-vecproj.html#sub-vecproj-add_and_mul" class="internal"><span class="codenumber">4.2.2</span> <span class="title">Vector addition and scalar multiplication</span></a></div></li>
<li><div class="toc-item"><a href="sec-linalg-vecproj.html#sub-vecproj-extras" class="internal"><span class="codenumber">4.2.3</span> <span class="title">Additional class methods</span></a></div></li>
<li><div class="toc-item"><a href="sec-linalg-vecproj.html#sub-vecproj-computations" class="internal"><span class="codenumber">4.2.4</span> <span class="title">‚ÄúSimple‚Äù computations</span></a></div></li>
</ul>
</li>
<li>
<div class="toc-item"><a href="sec-linalg-matrices.html" class="internal"><span class="codenumber">4.3</span> <span class="title">Complex matrices</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="sec-linalg-matrices.html#sub-linalg-matrices-matrix_vector_product" class="internal"><span class="codenumber">4.3.1</span> <span class="title">Matrix-vector products</span></a></div></li>
<li><div class="toc-item"><a href="sec-linalg-matrices.html#sub-linalg-matrices-matrix_matrix_product" class="internal"><span class="codenumber">4.3.2</span> <span class="title">Matrix-matrix products</span></a></div></li>
</ul>
</li>
<li>
<div class="toc-item"><a href="sec-linalg-matproj.html" class="internal"><span class="codenumber">4.4</span> <span class="title">Matrices in Python</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="sec-linalg-matproj.html#sub-linalg-matproj-basics" class="internal"><span class="codenumber">4.4.1</span> <span class="title"><code class="code-inline tex2jax_ignore">AlgoMatrix</code> basics</span></a></div></li>
<li><div class="toc-item"><a href="sec-linalg-matproj.html#sub-linalg-matproj-named_methods" class="internal"><span class="codenumber">4.4.2</span> <span class="title">Named <code class="code-inline tex2jax_ignore">AlgoMatrix</code> methods</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li>
<div class="toc-item"><a href="ch-matrix-apps.html" class="internal"><span class="codenumber">5</span> <span class="title">Matrix Applications</span></a></div>
<ul class="structural">
<li>
<div class="toc-item"><a href="sec-matapps-ssles.html" class="internal"><span class="codenumber">5.1</span> <span class="title">Solving Systems of Linear Equations</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="sec-matapps-ssles.html#sub-matapps-sles-rowops" class="internal"><span class="codenumber">5.1.1</span> <span class="title">Elementary row operations</span></a></div></li>
<li><div class="toc-item"><a href="sec-matapps-ssles.html#sub-matapps-sles-row_equivalence" class="internal"><span class="codenumber">5.1.2</span> <span class="title">Row equivalence and solutions to SLEs</span></a></div></li>
</ul>
</li>
<li>
<div class="toc-item"><a href="sec-matapps-gje_proj.html" class="internal"><span class="codenumber">5.2</span> <span class="title">GJE in Python</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="sec-matapps-gje_proj.html#sub-matapps-gje_np" class="internal"><span class="codenumber">5.2.1</span> <span class="title">Gauss-Jordan elimination with naive pivoting</span></a></div></li>
<li><div class="toc-item"><a href="sec-matapps-gje_proj.html#sub-matapps-gje_naive_flaw" class="internal"><span class="codenumber">5.2.2</span> <span class="title">Swamping: the computational flaw in naive pivoting</span></a></div></li>
<li><div class="toc-item"><a href="sec-matapps-gje_proj.html#sub-matapps-gje_pp" class="internal"><span class="codenumber">5.2.3</span> <span class="title">Gauss-Jordan elimination with partial pivoting</span></a></div></li>
<li><div class="toc-item"><a href="sec-matapps-gje_proj.html#sub-matapps-implement_gje_pp" class="internal"><span class="codenumber">5.2.4</span> <span class="title">Implementing GJE with PP</span></a></div></li>
</ul>
</li>
<li class="active">
<div class="toc-item"><a href="sec-matapps-ludecomp.html" class="internal"><span class="codenumber">5.3</span> <span class="title"><span class="process-math">\(PA=LU\)</span> Decomposition</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="sec-matapps-ludecomp.html#sub-matapps-ludecomp-theory" class="internal"><span class="codenumber">5.3.1</span> <span class="title">Special factors</span></a></div></li>
<li><div class="toc-item"><a href="sec-matapps-ludecomp.html#sub-matapps-ludecomp-solving" class="internal"><span class="codenumber">5.3.2</span> <span class="title">Solving systems via <span class="process-math">\(LU\)</span> decomposition</span></a></div></li>
<li><div class="toc-item"><a href="sec-matapps-ludecomp.html#sub-matapps-ludecomp-algo" class="internal"><span class="codenumber">5.3.3</span> <span class="title">Algorithms for <span class="process-math">\(LU\)</span> decomposition</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li>
<div class="toc-item"><a href="ch-gtalgos.html" class="internal"><span class="codenumber">6</span> <span class="title">Graph Theory Algorithms</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="sec-gtalgos-basics.html" class="internal"><span class="codenumber">6.1</span> <span class="title">Graph basics</span></a></div></li>
<li>
<div class="toc-item"><a href="sec-gtalgos-mst.html" class="internal"><span class="codenumber">6.2</span> <span class="title">Minimum spanning trees</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="sec-gtalgos-mst.html#sub-gtalgos-mst-jarnik_prim" class="internal"><span class="codenumber">6.2.1</span> <span class="title">Jarn√≠k-Prim Algorithm</span></a></div></li>
<li><div class="toc-item"><a href="sec-gtalgos-mst.html#sub-gtalgos-mst-minheaps" class="internal"><span class="codenumber">6.2.2</span> <span class="title">Min Heaps</span></a></div></li>
<li>
<div class="toc-item"><a href="sec-gtalgos-mst.html#sub-gtalgos-mst-kruskal" class="internal"><span class="codenumber">6.2.3</span> <span class="title">Kruskal's algorithm</span></a></div>
<ul class="structural"><li><div class="toc-item"><a href="sec-gtalgos-mst.html#subsubsection-7" class="internal"><span class="codenumber">6.2.3.1</span> <span class="title">Implementing Kruskal's algorithm</span></a></div></li></ul>
</li>
</ul>
</li>
<li>
<div class="toc-item"><a href="sec-gtalgos-shortestpath.html" class="internal"><span class="codenumber">6.3</span> <span class="title">Shortest Paths</span></a></div>
<ul class="structural"><li>
<div class="toc-item"><a href="sec-gtalgos-shortestpath.html#sub-gtalgos-shortestpath-dijkstra" class="internal"><span class="codenumber">6.3.1</span> <span class="title">Dijkstra's Algorithm</span></a></div>
<ul class="structural"><li><div class="toc-item"><a href="sec-gtalgos-shortestpath.html#subsubsection-8" class="internal"><span class="codenumber">6.3.1.1</span> <span class="title">A full example of Dijkstra's algorithm</span></a></div></li></ul>
</li></ul>
</li>
<li>
<div class="toc-item"><a href="sec-gtalgos-maxflowmincut.html" class="internal"><span class="codenumber">6.4</span> <span class="title">Maximizing flow</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="sec-gtalgos-maxflowmincut.html#sec-MaxFlow-MaxFlow" class="internal"><span class="codenumber">6.4.1</span> <span class="title">Max flow</span></a></div></li>
<li><div class="toc-item"><a href="sec-gtalgos-maxflowmincut.html#sec-MaxFlow-DinitzAlgo" class="internal"><span class="codenumber">6.4.2</span> <span class="title">Dinitz' Algorithm</span></a></div></li>
<li><div class="toc-item"><a href="sec-gtalgos-maxflowmincut.html#sec-MaxFlow-DinitzImpl" class="internal"><span class="codenumber">6.4.3</span> <span class="title">Implementing Dinitz' Algorithm</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li>
<div class="toc-item"><a href="aam-backmatter.html" class="internal"><span class="title">Back Matter</span></a></div>
<ul class="structural">
<li>
<div class="toc-item"><a href="app-python.html" class="internal"><span class="codenumber">A</span> <span class="title">Python crash course</span></a></div>
<ul class="structural">
<li>
<div class="toc-item"><a href="sec-intro-idle.html" class="internal"><span class="codenumber">A.1</span> <span class="title">Getting started with Python</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="sec-intro-idle.html#sub-intro-idle-gettingidle" class="internal"><span class="codenumber">A.1.1</span> <span class="title">Getting IDLE</span></a></div></li>
<li><div class="toc-item"><a href="sec-intro-idle.html#sub-intro-idle-interactivemode" class="internal"><span class="codenumber">A.1.2</span> <span class="title">Interactive Mode</span></a></div></li>
<li><div class="toc-item"><a href="sec-intro-idle.html#sub-intro-idle-firstprogram" class="internal"><span class="codenumber">A.1.3</span> <span class="title">A first Python module</span></a></div></li>
</ul>
</li>
<li>
<div class="toc-item"><a href="sec-intro_basicdata.html" class="internal"><span class="codenumber">A.2</span> <span class="title">Basic data types</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="sec-intro_basicdata.html#sub-intro-basicdata-numbers" class="internal"><span class="codenumber">A.2.1</span> <span class="title">Numerical data types</span></a></div></li>
<li>
<div class="toc-item"><a href="sec-intro_basicdata.html#sub-intro-basicdata-other" class="internal"><span class="codenumber">A.2.2</span> <span class="title">Non-numeric data types</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="sec-intro_basicdata.html#subsub-intro-basicdata-other-bool" class="internal"><span class="codenumber">A.2.2.1</span> <span class="title">Boolean variables</span></a></div></li>
<li><div class="toc-item"><a href="sec-intro_basicdata.html#subsub-intro-basicdata-other-str" class="internal"><span class="codenumber">A.2.2.2</span> <span class="title">Strings</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li>
<div class="toc-item"><a href="sec-intro-containers.html" class="internal"><span class="codenumber">A.3</span> <span class="title">Container data types</span></a></div>
<ul class="structural">
<li>
<div class="toc-item"><a href="sec-intro-containers.html#sub-intro-containers-lists" class="internal"><span class="codenumber">A.3.1</span> <span class="title">The <code class="code-inline tex2jax_ignore">list</code> data type</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="sec-intro-containers.html#subsub-intro-containers-lists-slices" class="internal"><span class="codenumber">A.3.1.1</span> <span class="title">Indexing and slicing</span></a></div></li>
<li><div class="toc-item"><a href="sec-intro-containers.html#subsub-intro-containers-lists-ops_meths" class="internal"><span class="codenumber">A.3.1.2</span> <span class="title">Operators and methods</span></a></div></li>
<li><div class="toc-item"><a href="sec-intro-containers.html#subsub-intro-containers-lists-mutable" class="internal"><span class="codenumber">A.3.1.3</span> <span class="title">Mutability</span></a></div></li>
</ul>
</li>
<li><div class="toc-item"><a href="sec-intro-containers.html#sub-intro-containers-tuples" class="internal"><span class="codenumber">A.3.2</span> <span class="title">The <code class="code-inline tex2jax_ignore">tuple</code> data type</span></a></div></li>
<li><div class="toc-item"><a href="sec-intro-containers.html#sub-intro-containers-dicts" class="internal"><span class="codenumber">A.3.3</span> <span class="title">The <code class="code-inline tex2jax_ignore">dict</code> data type</span></a></div></li>
<li><div class="toc-item"><a href="sec-intro-containers.html#subsection-53" class="internal"><span class="codenumber">A.3.4</span> <span class="title">Sets are a special container</span></a></div></li>
</ul>
</li>
<li>
<div class="toc-item"><a href="sec-intro-iteration.html" class="internal"><span class="codenumber">A.4</span> <span class="title">Iteration</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="sec-intro-iteration.html#sub-intro-iteration-for" class="internal"><span class="codenumber">A.4.1</span> <span class="title">For loops</span></a></div></li>
<li><div class="toc-item"><a href="sec-intro-iteration.html#sub-intro-iteration-while" class="internal"><span class="codenumber">A.4.2</span> <span class="title">While loops</span></a></div></li>
</ul>
</li>
<li>
<div class="toc-item"><a href="sec-intro-functions.html" class="internal"><span class="codenumber">A.5</span> <span class="title">Functions and conditional statements</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="sec-intro-functions.html#sub-intro-functions-def" class="internal"><span class="codenumber">A.5.1</span> <span class="title"><code class="code-inline tex2jax_ignore">def</code>ining new functions</span></a></div></li>
<li><div class="toc-item"><a href="sec-intro-functions.html#subsec-into-functions-conditionals" class="internal"><span class="codenumber">A.5.2</span> <span class="title">Controlling flow of programs</span></a></div></li>
<li><div class="toc-item"><a href="sec-intro-functions.html#sub-intro-functions-collatz" class="internal"><span class="codenumber">A.5.3</span> <span class="title">The Collatz Conjecture</span></a></div></li>
</ul>
</li>
<li>
<div class="toc-item"><a href="sec-intro-errors.html" class="internal"><span class="codenumber">A.6</span> <span class="title">Errors and exception handling</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="sec-intro-errors.html#sub-intro-errors-exceptions" class="internal"><span class="codenumber">A.6.1</span> <span class="title">Exceptions</span></a></div></li>
<li><div class="toc-item"><a href="sec-intro-errors.html#sub-intro-errors-handling" class="internal"><span class="codenumber">A.6.2</span> <span class="title">Handling exceptions</span></a></div></li>
<li><div class="toc-item"><a href="sec-intro-errors.html#sub-intro-errors-flow" class="internal"><span class="codenumber">A.6.3</span> <span class="title">Controlling the flow of a program</span></a></div></li>
<li><div class="toc-item"><a href="sec-intro-errors.html#sub-intro-errors-bugs" class="internal"><span class="codenumber">A.6.4</span> <span class="title">Semantic errors, or bugs</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li>
<div class="toc-item"><a href="appendix-lists.html" class="internal"><span class="codenumber">B</span> <span class="title">Finding ideas quickly</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="app-find-defs.html" class="internal"><span class="codenumber">B.1</span> <span class="title">Definitions</span></a></div></li>
<li><div class="toc-item"><a href="app-find-tech.html" class="internal"><span class="codenumber">B.2</span> <span class="title">Technology and Algorithms</span></a></div></li>
<li><div class="toc-item"><a href="app-find-results.html" class="internal"><span class="codenumber">B.3</span> <span class="title">Lemmas, Propositions, and Theorems</span></a></div></li>
<li><div class="toc-item"><a href="app-find-projects.html" class="internal"><span class="codenumber">B.4</span> <span class="title">Projects</span></a></div></li>
</ul>
</li>
<li><div class="toc-item"><a href="appendix-gfdl.html" class="internal"><span class="codenumber">C</span> <span class="title">GNU Free Documentation License</span></a></div></li>
<li><div class="toc-item"><a href="colophon-2.html" class="internal"><span class="title">Colophon</span></a></div></li>
</ul>
</li>
</ul></nav></div>
<main class="ptx-main"><div id="ptx-content" class="ptx-content"><section class="section" id="sec-matapps-ludecomp"><h2 class="heading hide-type">
<span class="type">Section</span> <span class="codenumber">5.3</span> <span class="title"><span class="process-math">\(PA=LU\)</span> Decomposition</span>
</h2>
<section class="introduction" id="introduction-53"><div class="para logical" id="p-688">
<div class="para">An application of the Gaussian elimination algorithm without its Jordan component is involved in a procedure for solving multiple matrix equations. Consider that there is a matrix <span class="process-math">\(A\in\Mats{n,n}\)</span> and a set of vectors</div>
<div class="displaymath process-math">
\begin{equation*}
B=\set{\vec{b}_k:k\in\set{0,1,\dotsc,\ell-1}}
\end{equation*}
</div>
<div class="para">such that all the solutions to <span class="process-math">\(A\vv=\vec{b}_k\)</span> must be determined for all <span class="process-math">\(k\text{.}\)</span> In order to solve all of these problems using Gauss-Jordan elimination in a naive manner, it would be necessary to perform the GJE process <span class="process-math">\(\ell\)</span> times. A technique which allows GJE to be performed only once would be of great benefit.</div>
</div></section><section class="subsection" id="sub-matapps-ludecomp-theory"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">5.3.1</span> <span class="title">Special factors</span>
</h3>
<div class="para" id="p-689">In general, any representation of a matrix <span class="process-math">\(A\)</span> of the form <span class="process-math">\(A=BC\)</span> is referred to as a <dfn class="terminology">decomposition</dfn> or <dfn class="terminology">factorization</dfn> of <span class="process-math">\(A\text{;}\)</span> the type of decomposition depends upon the desired properties of the factors. We begin with a definition of two interesting types of square matrices: upper and lower triangular matrices.</div>
<article class="definition definition-like" id="defn-triangular_matrix"><h4 class="heading">
<span class="type">Definition</span><span class="space"> </span><span class="codenumber">5.3.1</span><span class="period">.</span><span class="space"> </span><span class="title">Triangular matrices.</span>
</h4> <div class="para logical" id="p-690">
<div class="para">A matrix <span class="process-math">\(A\in\Mats{m,n}\)</span> is <dfn class="terminology">square</dfn> if and only if <span class="process-math">\(m=n\text{.}\)</span> A square matrix <span class="process-math">\(A\in\Mats{n,n}\)</span> is</div>
<dl class="description-list">
<dt id="li-145">Upper triangular</dt>
<dd><div class="para" id="p-691">if and only if <span class="process-math">\(\entry{A}{r,c} = 0\)</span> whenever <span class="process-math">\(r\gt c\text{,}\)</span>
</div></dd>
<dt id="li-146">Lower triangular</dt>
<dd><div class="para" id="p-692">if and only if <span class="process-math">\(\entry{A}{r,c}=0\)</span> whenever <span class="process-math">\(r\lt c\text{,}\)</span> and is</div></dd>
<dt id="li-147">Diagonal</dt>
<dd><div class="para" id="p-693">if and only if <span class="process-math">\(\entry{A}{r,c}=0\)</span> whenever <span class="process-math">\(r\neq c\text{.}\)</span>
</div></dd>
</dl>
</div></article><div class="para logical" id="p-694">
<div class="para">Every square matrix which is in row-echelon form is necessarily upper triangular, and a careful application of the Gaussian elimination algorithm to a matrix <span class="process-math">\(A\)</span> will produce matrices <span class="process-math">\(P\text{,}\)</span> <span class="process-math">\(L\text{,}\)</span> and <span class="process-math">\(U\)</span> such that</div>
<ul class="disc">
<li id="li-148"><div class="para" id="p-695">
<span class="process-math">\(P\)</span> is a permutation matrix obtained as a product of <span class="process-math">\(S_{k,l}\)</span> row-swapping matrices,</div></li>
<li id="li-149"><div class="para" id="p-696">
<span class="process-math">\(L\)</span> is lower triangular, and</div></li>
<li id="li-150"><div class="para" id="p-697">
<span class="process-math">\(U\)</span> is upper triangular and row-equivalent to <span class="process-math">\(PA\text{.}\)</span>
</div></li>
</ul>
</div>
<article class="theorem theorem-like" id="thm-ludecomp"><h4 class="heading">
<span class="type">Theorem</span><span class="space"> </span><span class="codenumber">5.3.2</span><span class="period">.</span><span class="space"> </span><span class="title"><span class="process-math">\(PA=LU\)</span> decomposition of <span class="process-math">\(A\)</span>.</span>
</h4>
<div class="para" id="p-698">Suppose that <span class="process-math">\(A\in\Mats{n,n}\)</span> is an invertible matrix. Then there is a permutation matrix <span class="process-math">\(P\)</span> and a pair of lower and upper triangular matrices <span class="process-math">\(L\)</span> and <span class="process-math">\(U\)</span> such that <span class="process-math">\(PA=LU\text{.}\)</span>
</div></article><article class="hiddenproof" id="proof-14"><a href="" data-knowl="" class="id-ref proof-knowl original" data-refid="hk-proof-14"><h4 class="heading"><span class="type">Proof<span class="period">.</span></span></h4></a></article><div class="hidden-content tex2jax_ignore" id="hk-proof-14"><article class="hiddenproof"><div class="para" id="p-699">We will apply the Gaussian elimination algorithm with partial pivoting (GEPP) but limiting the eligible row operations only to swapping rows via <span class="process-math">\(\rswap{k}{\ell}\)</span> and elimination via <span class="process-math">\(\relim{\alpha}{k}{\ell}\text{.}\)</span> Initially let <span class="process-math">\(P=I_n\text{,}\)</span> the identity matrix in <span class="process-math">\(\Mats{n,n}\text{;}\)</span> we will modify a matrix <span class="process-math">\(M\)</span> which is initally equal to <span class="process-math">\(A\text{.}\)</span>
</div> <div class="para" id="p-700">In the process of applying the GEPP algorithm to <span class="process-math">\(M\text{,}\)</span> whenever an operation <span class="process-math">\(M\xmapsto{\rswap{k}{\ell}}M\)</span> occurs, also perform <span class="process-math">\(P\xmapsto{\rswap{k}{\ell}}\text{.}\)</span> Moreover, when the operation <span class="process-math">\(M\xmapsto{\relim{\alpha}{k}{\ell}}\)</span> is applied to eliminate a value in row index <span class="process-math">\(\ell\)</span> and column index <span class="process-math">\(k\text{,}\)</span> rather than writing <span class="process-math">\(\entry{M}{\ell}{k}=0\)</span> put <span class="process-math">\(\entry{M}{\ell}{k} = -\alpha\text{.}\)</span>
</div> <div class="para logical" id="p-701">
<div class="para">When the GEPP algorithm completes, the matrix <span class="process-math">\(P\)</span> is the correct permutation matrix. The matrix <span class="process-math">\(M\)</span> contains all of the necessary elements of both matrices <span class="process-math">\(L\)</span> and <span class="process-math">\(U\text{,}\)</span> which meed to be extracted into the triangular matrices. Specifically we let <span class="process-math">\(L\in\Mats{n,n}\)</span> be the lower triangular matrix satisfying</div>
<div class="displaymath process-math">
\begin{equation*}
\entry{L}{r,c} = \begin{cases}
0\amp\text{if }r \lt c \\
1\amp\text{if }r = c \\
\entry{M}{r,c}\amp\text{if }r\gt c.
\end{cases}
\end{equation*}
</div>
<div class="para">Further, <span class="process-math">\(U\in\Mats{n,n}\)</span> is the upper triangular matrix satisfying</div>
<div class="displaymath process-math">
\begin{equation*}
\entry{U}{r,c} = \begin{cases}
0 \amp\text{if} r\gt c \\
\entry{M}{r,c}\amp\text{if }r\lt c.
\end{cases}
\end{equation*}
</div>
</div> <div class="para" id="p-702">Since this matrix <span class="process-math">\(L\)</span> is the product of the inverse matrices <span class="process-math">\(E_{\alpha,k,\ell}^{-1}\)</span> corresponding to each of the eliminations mentioned previously, and <span class="process-math">\(U\)</span> is the result of those eliminations, it is necessarily the case that <span class="process-math">\(PA=LU\text{.}\)</span>
</div></article></div>
<article class="example example-like" id="exmp-ludecomp-worked"><h4 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">5.3.3</span><span class="period">.</span><span class="space"> </span><span class="title">A worked <span class="process-math">\(PA=LU\)</span> decomposition example.</span>
</h4>
<div class="para logical" id="p-703">
<div class="para">Suppose that</div>
<div class="displaymath process-math">
\begin{equation*}
A = \begin{bmatrix}
1 \amp 4 \amp 9 \amp 7 \\
5 \amp 6 \amp 8 \amp 3 \\
8 \amp 7 \amp 2 \amp 7 \\
5 \amp 4 \amp 1 \amp 2
\end{bmatrix}\text{.}
\end{equation*}
</div>
<div class="para">Then the sequence of row operations and resulting matrices <span class="process-math">\(M\)</span> are as follows below. Notice that the value of the permutation matrix <span class="process-math">\(P\)</span> is only given when it changes, and entries of <span class="process-math">\(M\)</span> enclosed in boxes are those which are recorded to be extracted into <span class="process-math">\(L\text{.}\)</span>
</div>
<div class="displaymath process-math" id="md-31">
\begin{align*}
M = \begin{bmatrix}
1 \amp 4 \amp 9 \amp 7 \\
5 \amp 6 \amp 8 \amp 3 \\
8 \amp 7 \amp 2 \amp 7 \\
5 \amp 4 \amp 1 \amp 2
\end{bmatrix}
\xto{\rswap{0}{2}} \amp
\begin{bmatrix}
8 \amp 7 \amp 2 \amp 7 \\
5 \amp 6 \amp 8 \amp 3 \\
1 \amp 4 \amp 9 \amp 7 \\
5 \amp 4 \amp 1 \amp 2
\end{bmatrix}, P=\begin{bmatrix}
0 \amp 0 \amp 1 \amp 0 \\
0 \amp 1 \amp 0 \amp 0 \\
1 \amp 0 \amp 0 \amp 0 \\
0 \amp 0 \amp 0 \amp 1
\end{bmatrix}\\
\xto{\begin{smallmatrix}
\relim{-5/8}{0}{1}\\
\relim{-1/8}{0}{2} \\
\relim{-5/8}{0}{3}
\end{smallmatrix}} \amp
\begin{bmatrix}
8 \amp 7 \amp 2 \amp 7 \\
\fbox{$5/8$} \amp 13/8 \amp 27/4 \amp -11/8 \\
\fbox{$1/8$} \amp 25/8 \amp 35/4 \amp 49/8 \\
\fbox{$5/8$} \amp -3/8 \amp -1/4 \amp -19/8
\end{bmatrix}\\
\xto{\rswap{1}{2}} \amp
\begin{bmatrix}
8 \amp 7 \amp 2 \amp 7 \\
\fbox{$1/8$} \amp 25/8 \amp 35/4 \amp 49/8 \\
\fbox{$5/8$} \amp 13/8 \amp 27/4 \amp -11/8 \\
\fbox{$5/8$} \amp -3/8 \amp -1/4 \amp -19/8
\end{bmatrix}, P = \begin{bmatrix}
0 \amp 0 \amp 1 \amp 0 \\
1 \amp 0 \amp 0 \amp 0 \\
0 \amp 1 \amp 0 \amp 0 \\
0 \amp 0 \amp 0 \amp 1
\end{bmatrix}\\
\xto{\begin{smallmatrix}
\relim{-13/25}{1}{2} \\
\relim{3/25}{1}{3}
\end{smallmatrix}} \amp
\begin{bmatrix}
8 \amp 7 \amp 2 \amp 7 \\
\fbox{$1/8$} \amp 25/8 \amp 35/4 \amp 49/8 \\
\fbox{$5/8$} \amp \fbox{$13/25$} \amp 11/5 \amp -114/25 \\
\fbox{$5/8$} \amp \fbox{$-3/25$} \amp 4/5 \amp -41/25
\end{bmatrix}\\
\xto{\relim{-4/11}{2}{3}} \amp
\begin{bmatrix}
8 \amp 7 \amp 2 \amp 7 \\
\fbox{$1/8$} \amp 25/8 \amp 35/4 \amp 49/8 \\
\fbox{$5/8$} \amp \fbox{$13/25$} \amp 11/5 \amp -114/25 \\
\fbox{$5/8$} \amp \fbox{$-3/25$} \amp \fbox{$4/11$} \amp 1/55
\end{bmatrix}
\end{align*}
</div>
</div> <div class="para logical" id="p-704">
<div class="para">Extracting <span class="process-math">\(L\)</span> and <span class="process-math">\(U\)</span> from this matrix, we obtain</div>
<div class="displaymath process-math">
\begin{equation*}
P = \left[~\begin{smallmatrix}
0 \amp 0 \amp 1 \amp 0 \\
1 \amp 0 \amp 0 \amp 0 \\
0 \amp 1 \amp 0 \amp 0 \\
0 \amp 0 \amp 0 \amp 1
\end{smallmatrix}~\right]\qquad
L = \left[~\begin{smallmatrix}
1 \amp 0 \amp 0 \amp 0 \\
1/8 \amp 1 \amp 0 \amp 0 \\
5/8 \amp 13/25 \amp 1 \amp 0 \\
5/8 \amp -3/25 \amp 4/11 \amp 1
\end{smallmatrix}~\right]\qquad
U = \left[~\begin{smallmatrix}
8 \amp 7 \amp 2 \amp 7 \\
0 \amp 25/8 \amp 35/4 \amp 49/8 \\
0 \amp 0 \amp 11/5 \amp -114/25 \\
0 \amp 0 \amp 0 \amp 1/55
\end{smallmatrix}~\right]
\end{equation*}
</div>
</div></article></section><section class="subsection" id="sub-matapps-ludecomp-solving"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">5.3.2</span> <span class="title">Solving systems via <span class="process-math">\(LU\)</span> decomposition</span>
</h3>
<div class="para" id="p-705">Now we can put this decomposition to work using basic algebra properties of matrices to solve a simple matrix equation. Beginning from <span class="process-math">\(A\vec{x} = \vec{b}\)</span> when <span class="process-math">\(PA=LU\text{,}\)</span> we observe that <span class="process-math">\(PA\vec{x} = P\vec{b}\text{,}\)</span> so <span class="process-math">\(LU\vec{x} = P\vec{b}\text{.}\)</span> Introducing an intermediate equation <span class="process-math">\(U\vec{x} = \vec{y}\)</span> and writing <span class="process-math">\(\vec{b}' = P\vec{b}\text{,}\)</span> we have to solve <span class="process-math">\(L\vec{y} = \vec{b}'\)</span> and then <span class="process-math">\(U\vec{x} = \vec{y}\text{.}\)</span> These are easy to solve via substitution.</div>
<article class="theorem theorem-like" id="thm-forward-sub"><h4 class="heading">
<span class="type">Theorem</span><span class="space"> </span><span class="codenumber">5.3.4</span><span class="period">.</span><span class="space"> </span><span class="title">Solution via forward substitution.</span>
</h4>
<div class="para logical" id="p-706">
<div class="para">Given an invertible lower triangular matrix <span class="process-math">\(L\in\Mats{n,n}\)</span> and a vector <span class="process-math">\(\vec{b}\text{,}\)</span> the solution <span class="process-math">\(\vec{y}\)</span> to the matrix-vector product equation <span class="process-math">\(L\vec{y}=\vec{b}\)</span> satisfies</div>
<div class="displaymath process-math">
\begin{equation*}
\entry{\vec{y}}{r} =
\left(
\entry{\vec{b}}{r} - \sum_{c=0}^{r-1}\entry{L}{r,c}\entry{\vec{y}}{c}
\right)/\entry{L}{r,r}\text{,}
\end{equation*}
</div>
<div class="para">and as such solving for <span class="process-math">\(\entry{y}{r}\)</span> in the order of <span class="process-math">\(r = 0,1,2,\dotsc, n-2,n-1\)</span> involves only direct substitution.</div>
</div></article><article class="theorem theorem-like" id="thm-back_sub"><h4 class="heading">
<span class="type">Theorem</span><span class="space"> </span><span class="codenumber">5.3.5</span><span class="period">.</span><span class="space"> </span><span class="title">Solution via back substitution.</span>
</h4>
<div class="para logical" id="p-707">
<div class="para">Given an invertible upper triangular matrix <span class="process-math">\(U\in\Mats{n,n}\)</span> and a vector <span class="process-math">\(\vec{y}\text{,}\)</span> the solution <span class="process-math">\(\vec{x}\)</span> to the matrix-vector product equation <span class="process-math">\(U\vec{x}=\vec{y}\)</span> satisfies</div>
<div class="displaymath process-math">
\begin{equation*}
\entry{\vec{x}}{r} =
\left(
\entry{\vec{y}}{r} - \sum_{c=r+1}^{n-1}\entry{U}{r,c}\entry{\vec{x}}{c}
\right)/\entry{U}{r,r}\text{,}
\end{equation*}
</div>
<div class="para">and as such solving for <span class="process-math">\(\entry{x}{r}\)</span> in the order of <span class="process-math">\(r = n-1,n-2,\dotsc,2,1,0\)</span> involves only direct substitution.</div>
</div></article></section><section class="subsection" id="sub-matapps-ludecomp-algo"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">5.3.3</span> <span class="title">Algorithms for <span class="process-math">\(LU\)</span> decomposition</span>
</h3>
<div class="para" id="p-708">The algorithm for <span class="process-math">\(PA=LU\)</span> decomposition is little different from any other Gaussian elimination algorithm. In order to operate efficiently and not require the same row operations to be performed on multiple matrices, we will carefully work in a list of lists and convert the final result to a tuple of three <code class="code-inline tex2jax_ignore">AlgoMatrix</code> objects.</div>
<article class="algorithm theorem-like" id="algo-ludecomp"><h4 class="heading">
<span class="type">Algorithm</span><span class="space"> </span><span class="codenumber">5.3.6</span><span class="period">.</span><span class="space"> </span><span class="title"><span class="process-math">\(PA=LU\)</span> decomposition.</span>
</h4>
<div class="para logical" id="p-709">
<div class="para">Suppose that <span class="process-math">\(A\in\Mats{n,n}\)</span> be a matrix, and initialize <span class="process-math">\(P=I_n\)</span> to  be the identity matrix of size <span class="process-math">\(n\text{.}\)</span>
</div>
<ol class="decimal">
<li id="li-151"><div class="para" id="p-710">Let <span class="process-math">\(r=0\)</span> and <span class="process-math">\(c=0\)</span>
</div></li>
<li id="li-152"><div class="para logical" id="p-711">
<div class="para">While <span class="process-math">\(r\lt n\)</span> and <span class="process-math">\(c\lt n\text{,}\)</span> repeat the following:</div>
<ol class="lower-alpha">
<li id="li-153">
<span class="heading"><span class="title">Partial pivoting.</span></span><div class="para logical" id="p-712"><ol class="lower-roman">
<li id="li-154"><div class="para" id="p-713">If all <span class="process-math">\(\entry{A}{r',c}=0\)</span> for <span class="process-math">\(r'\in\set{r+1,\dotsc,n-1}\text{,}\)</span> increase <span class="process-math">\(c\)</span> by 1 and return to step (2).</div></li>
<li id="li-155"><div class="para logical" id="p-714">
<div class="para">Let <span class="process-math">\(p\)</span> be the least row index such that</div>
<div class="displaymath process-math">
\begin{equation*}
\abs{\entry{A}{p,c}}=\max\set{\abs{\entry{A}{r',c}}:r'\in\set{r+1,\dotsc,m-1}}\text{.}
\end{equation*}
</div>
</div></li>
<li id="li-156"><div class="para" id="p-715">If <span class="process-math">\(p\neq r\text{,}\)</span> then <span class="process-math">\(A\xmapsto{\rswap{r}{p}} A\)</span> and <span class="process-math">\(P\xmapsto{\rswap{r}{p}} P\text{;}\)</span> otherwise proceed to step (2.b).</div></li>
</ol></div>
</li>
<li id="li-157">
<span class="heading"><span class="title">Elimination.</span></span><div class="para logical" id="p-716">
<div class="para">For each <span class="process-math">\(r'\in\set{r+1,\dotsc,m-1}\)</span> do the following:</div>
<ol class="lower-roman">
<li id="li-158"><div class="para" id="p-717">If <span class="process-math">\(\entry{A}{r',c}=0\text{,}\)</span> continue to the next value of <span class="process-math">\(r'\text{.}\)</span>
</div></li>
<li id="li-159"><div class="para" id="p-718">Otherwise, let <span class="process-math">\(\alpha = \entry{A}{r',c}/\entry{A}{r,c}\text{.}\)</span>
</div></li>
<li id="li-160"><div class="para" id="p-719">For each <span class="process-math">\(c'\in\set{c+1,\dotsc,n-1}\text{,}\)</span> update the value of <span class="process-math">\(\entry{A}{r',c'}\)</span> by setting it equal to <span class="process-math">\(-\alpha\entry{A}{r,c'} + \entry{A}{r',c'}\)</span> via the elimination operation.</div></li>
<li id="li-161"><div class="para" id="p-720">Reset <span class="process-math">\(\entry{A}{r',c} = \alpha\text{.}\)</span>
</div></li>
</ol>
</div>
</li>
<li id="li-162"><div class="para" id="p-721">Increase <span class="process-math">\(r\)</span> and <span class="process-math">\(c\)</span> each by 1.</div></li>
</ol>
</div></li>
<li id="li-163"><div class="para logical" id="p-722">
<div class="para">When the while loop in step (2) terminates, the matrix <span class="process-math">\(P\)</span> is the correct permutation matrix, and we may simply extract the values of <span class="process-math">\(L\)</span> and <span class="process-math">\(U\)</span> from <span class="process-math">\(A\text{.}\)</span>
</div>
<ol class="lower-alpha">
<li id="li-164"><div class="para logical" id="p-723">
<div class="para">Let <span class="process-math">\(L\in\Mats{n,n}\)</span> be the matrix satisfying</div>
<div class="displaymath process-math">
\begin{equation*}
\entry{L}{r,c} = \begin{cases}
0,\amp\text{if }r\lt c \\
1,\amp\text{if }r=c\\
\entry{A}{r,c},\amp\text{if }r\gt c
\end{cases}
\end{equation*}
</div>
</div></li>
<li id="li-165"><div class="para logical" id="p-724">
<div class="para">Let <span class="process-math">\(U\in\Mats{n,n}\)</span> be the matrix satisfying</div>
<div class="displaymath process-math">
\begin{equation*}
\entry{U}{r,c} = \begin{cases}
0,\amp\text{if }r\gt c\\
\entry{A}{r,c},\amp\text{if }r\leq c
\end{cases}
\end{equation*}
</div>
</div></li>
</ol>
</div></li>
</ol>
</div></article><div class="para" id="p-725">A crucial and easy-to-miss part of the <span class="process-math">\(PA=LU\)</span> algorithm is Step (2.b.iii); in order to store the values for <span class="process-math">\(L\)</span> in place of the unnecessary zeroes which normally appear below the diagonal of a matrix in row-echelon form, it is essential that only the values to the right of the diagonal be recomputed during the elimination steps. The elimination which actually is known to send values to zero must not do so, otherwise the lower triangular matrix <span class="process-math">\(L\)</span> is lost. The following is a method implementing our algorithm, suitable fo inclusion in the <code class="code-inline tex2jax_ignore">AlgoMatrix</code> class.</div>
<figure class="listing figure-like" id="listing-15"><div class="code-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><pre class="program"><code class="language-py">def palu(self, debug=False):
    m,n = self.dims()
    if m!=n: raise ValueError("Cannot PA=LU decompose nonsquare matrix.")
    # Initialize grids
    grid = [[entry for entry in row] for row in self._data] # Skim the data
    pmat = [[1 if r==c else 0 for c in range(n)] for r in range(m)]
    debug_out = []
    # Start at upper left
    r,c = 0,0
    while (r &lt; m) and (c &lt; n):
        # Check if rows need swapped
        debug_out.append( str(grid) )
        cur_max = abs(grid[r][c])
        piv = r
        for r_prime in range(r+1, m):
            if abs(grid[r_prime][c]) &gt; cur_max:
                cur_max = abs(grid[r_prime][c])
                piv = r_prime
        # if cur_max == 0, shift right.
        if cur_max == 0:
            c += 1
            continue
            # otherwise check if rows need swapped
        elif piv != r:
            debug_out.append(f"Swap R({r})&lt;-&gt;R({r_prime})")
            # interchange elements of lists
            grid[piv],grid[r] = grid[r],grid[piv]
            pmat[piv],pmat[r] = pmat[r],pmat[piv]
        # No scaling
        # Elimination
        for r_prime in range(r+1, m):
            if grid[r_prime][c] == 0: continue
            alpha = grid[r_prime][c] / grid[r][c]
            # Since we want to maintain the lower-triangular part for L, we only alter
            # columns c+1 through n of grid[r_prime]
            grid[r_prime][c+1:] = [-alpha*grid[r][c_prime] + grid[r_prime][c_prime] for c_prime in range(c+1,n)]
            # Then store the alpha value in grid[r_prime][c] to pull out for L later
            grid[r_prime][c] = alpha
            debug_out.append(f"Elim ({-alpha})*R({r}) + R({r_prime})")
        r += 1
        c += 1
    P = AlgoMatrix(pmat)
    L = AlgoMatrix([[1 if r==c else (grid[r][c] if r &gt; c else 0) for c in range(n)] for r in range(m)])
    U = AlgoMatrix([[grid[r][c] if r &lt;= c else 0 for c in range(n)] for r in range(m)])
    if debug: print("\n".join(debug_out))
    return P,L,U
</code></pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">5.3.7<span class="period">.</span></span><span class="space"> </span>An implementation of the <span class="process-math">\(PA=LU\)</span> algorithm using partial pivoting.</figcaption></figure></section></section></div>
<div class="ptx-content-footer">
<a class="previous-button button" href="sec-matapps-gje_proj.html" title="Previous"><span class="icon">&lt;</span><span class="name">Prev</span></a><a class="top-button button" href="#" title="Top"><span class="icon">^</span><span class="name">Top</span></a><a class="next-button button" href="ch-gtalgos.html" title="Next"><span class="name">Next</span><span class="icon">&gt;</span></a>
</div></main>
</div>
<div class="ptx-page-footer">
<a class="pretext-link" href="https://pretextbook.org"><div class="name">Authored in PreTeXt</div>
<div class="logo"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="338 3000 8772 6866"><g style="stroke-width:.025in; stroke:black; fill:none"><polyline points="472,3590 472,9732 " style="stroke:#000000;stroke-width:174; stroke-linejoin:miter; stroke-linecap:round; "></polyline><path style="stroke:#000000;stroke-width:126;stroke-linecap:butt;" d="M 4724,9448 A 4660 4660  0  0  1  8598  9259 "></path><path style="stroke:#000000;stroke-width:174;stroke-linecap:butt;" d="M 4488,9685 A 4228 4228  0  0  0  472  9732 "></path><path style="stroke:#000000;stroke-width:126;stroke-linecap:butt;" d="M 4724,3590 A 4241 4241  0  0  1  8598  3496 "></path><path style="stroke:#000000;stroke-width:126;stroke-linecap:round;" d="M 850,3496 A 4241 4241  0  0  1  4724  3590 "></path><path style="stroke:#000000;stroke-width:126;stroke-linecap:round;" d="M 850,9259 A 4507 4507  0  0  1  4724  9448 "></path><polyline points="5385,4299 4062,8125 " style="stroke:#000000;stroke-width:300; stroke-linejoin:miter; stroke-linecap:round; "></polyline><polyline points="8598,3496 8598,9259 " style="stroke:#000000;stroke-width:126; stroke-linejoin:miter; stroke-linecap:round; "></polyline><polyline points="850,3496 850,9259 " style="stroke:#000000;stroke-width:126; stroke-linejoin:miter; stroke-linecap:round; "></polyline><polyline points="4960,9685 4488,9685 " style="stroke:#000000;stroke-width:174; stroke-linejoin:miter; stroke-linecap:round; "></polyline><polyline points="3070,4582 1889,6141 3070,7700 " style="stroke:#000000;stroke-width:300; stroke-linejoin:miter; stroke-linecap:round; "></polyline><polyline points="6418,4582 7600,6141 6418,7700 " style="stroke:#000000;stroke-width:300; stroke-linejoin:miter; stroke-linecap:round; "></polyline><polyline points="8976,3590 8976,9732 " style="stroke:#000000;stroke-width:174; stroke-linejoin:miter; stroke-linecap:round; "></polyline><path style="stroke:#000000;stroke-width:174;stroke-linecap:butt;" d="M 4960,9685 A 4228 4228  0  0  1  8976  9732 "></path></g></svg></div></a><a class="runestone-link" href="https://runestone.academy"><div class="name">Powered by Runestone</div>
<img class="logo" title="Powered by Runestone" src="https://runestone.academy/runestone/static/rectangle_badge.png" alt="Powered by Runestone"></a><a class="mathjax-logo" href="https://www.mathjax.org"><img title="Powered by MathJax" src="https://www.mathjax.org/badge/badge.gif" alt="Powered by MathJax"></a>
</div>
</body>
</html>
