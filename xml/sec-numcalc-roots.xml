<?xml version="1.0" encoding="UTF-8"?>
<section xml:id="s-NC-RF">
    <title>Root finding</title>
    <introduction>
        <p>
            We begin with some preliminary definitions.
        </p>
        <definition xml:id="def-function_root">
            <title>Root of a function</title>
            <idx><h>root</h><h>of a function</h></idx>
            <statement>
                <p>
                    A <term>function</term> <m>f</m> is most easily understood to be a rule assigning to each element of a set <m>A</m>, called the <term>domain of <m>f</m></term>, exactly one value in a set <m>B</m>, called the <term>codomain of <m>f</m></term>. This is denoted <m>f: A\to B</m>. When <m>A</m> and <m>B</m> are subsets of the real numbers <m>\R</m>, we say that <m>a\in A</m> is a <term>root of <m>f</m></term> if and only if <m>f(a)=0</m>.
                </p>
            </statement>
        </definition>
        <definition xml:id="def-function_limit">
            <idx><h>limit</h><h>of a function</h></idx>
            <title>Limit of a function</title>
            <statement>
                <p>
                    The function <m>f:\R\to\R</m> has a <term>limit</term> of <m>L</m> at <m>a\in \R</m>, written <m>\lim_{x\to a}f(x) = L</m>, if and only if for every <m>\epsilon\gt 0</m> there is a corresponding <m>\delta\gt 0</m> such that <m>\abs{f(x)-L}\lt\epsilon</m> whenever <m>\abs{x-a}\lt\delta</m>.
                </p>
                <p>
                    Loosely speaking, this says that the value of <m>f(x)</m> approaches <m>L</m> as <m>x</m> approaches <m>a</m>.
                </p>
            </statement>
        </definition>
        <definition xml:id="def-continuous_function">
            <title>Continuous function</title>
            <idx><h>continuous function</h><h>at a point</h></idx>
            <idx><h>continuous function</h><h>on an interval</h></idx>
            <statement>
                <p>
                    A function <m>f:\R\to\R</m> is <term>continuous at a point <m>a</m></term> in its domain if and only if for each <m>\epsilon\gt 0</m> there is a corresponding <m>\delta\gt 0</m> such that <m>\abs{f(x)-f(a)}\lt \epsilon</m> whenever <m>\abs{x-a}\lt\delta</m>. Equivalently <m>f</m> is continuous at <m>a</m> exactly when
                    <ol>
                        <li><m>f(a)</m> exists,</li>
                        <li><m>\lim_{x\to a}f(x)</m> exists, and</li>
                        <li><m>\lim_{x\to a}f(x) = f(a).</m></li>
                    </ol>
                </p>
                <p>
                    The function <m>f:\R\to\R</m> is <term>continuous on an interval <m>[a,b]</m></term> if <m>f</m> is continuous at <m>c</m> for every value <m>c</m> such that <m>a\leq c\leq b</m>.
                </p>
            </statement>
        </definition>
        <p>
            <xref ref="def-function_limit"/> is arguably the only <q>real</q> definition in all of Calculus, as the idea of the limit (and the handling of infinitesimal quantities in general) is precisely the idea that was needed for the discovery of the discipline at the end of the 17th century.
        </p>
    </introduction>
    <subsection xml:id="ss-NC-RF-IB">
        <title>Interval bisection</title>
        <p>
            For continuous functions there are cases when we can ensure that at least one root exists in a given interval, via the <xref ref="thm-intermediate_value_theorem"  text="title"/>.
        </p>
        <theorem xml:id="thm-intermediate_value_theorem">
            <idx>Intermediate value theorem</idx>
            <title>Intermediate value theorem</title>
            <shorttitle>IVT</shorttitle>
            <statement>
                <p>
                    Suppose that <m>f:\R\to\R</m> is continuous on the interval <m>[a,b]</m>, and that (without loss of generality) <m>f(a)\lt f(b)</m>. Then for every value <m>y</m> such that <m>f(a)\lt y\lt f(b)</m>, there is some <m>c</m> in <m>(a,b)</m> such that <m>f(c)=y</m>.
                </p>
            </statement>
        </theorem>
        <exercise>
            <title>Applying the IVT for root-finding</title>
            <statement>
                What additional hypotheses to the Intermediate value theorem are necessary to use it as a necessary condition for the existence of a root of <m>f</m> in the interval <m>[a,b]</m>?
            </statement>
            <answer>
                If either <m>f(a)\lt 0\lt f(b)</m> or <m>f(a) \gt 0 \gt f(b)</m> and <m>f</m> is continuous on <m>[a,b]</m>, then there is number <m>c</m> in <m>(a,b)</m> such that <m>f(c)=0</m>!
            </answer>
        </exercise>
        <p>
            Intermediate value theorem in hand we are able to consider a process for finding a root in an interval when the root provably exists. Suppose we know that <m>f</m> has a root in the interval <m>[a,b]</m>: <m>f</m> is continuous on the interval <m>[a,b]</m> and <m>f(a)\lt 0\lt f(b)</m>. Now consider the midpoint of the interval, <m>m = (a+b)/2</m>. There are only three possibilities for the value of <m>f(m)</m>:
            <ol>
                <li><m>f(m) = 0</m>, and we have discovered a root in the interval <m>(a,b)</m>, </li>
                <li><m>f(m) \lt 0</m>, and we have a smaller interval <m>[m,b]</m> on which <m>f</m> is continuous, satisfying <m>f(m)\lt 0\lt f(b)</m>,</li>
                <li> or <m>f(m)\gt 0</m> so that <m>f(a)\lt 0\lt f(m)</m>, again giving us a smaller interval on which <m>f</m> is continuous and satisfying the hypotheses of our application of the IVT.</li>
            </ol>
        </p>
        <p>
            We can apply this <term>interval bisection method</term> over and over again, on each repetition cutting the width of the interval in half. Since the initial (<m>0^\text{th}</m>) interval width is <m>w = b-a</m>, we know on the <m>n^\text{th}</m> iteration that we'll be looking at an interval of width <m>\frac{w}{2^n}</m>. Eventually this will be <q>arbitrarily close</q> to a root <emdash /> which is to say, for any <m>\delta \gt 0</m> there is some <m>n>0</m> such that <m>0\lt \frac{w}{2^n}\lt \delta</m>. Thus when we know that the midpoint of our interval is <q>close enough</q> to a root, we can terminate the algorithm! This is called <term>convergence</term> of the algorithm, because the sequence of successive approximations always converges.
        </p>
        <definition xml:id="def-convergence">
            <idx><h>convergence</h><h>of a sequence</h></idx>
            <title>Convergence of a sequence</title>
            <statement>
                A sequence <m>\set{a_n:n\in\Z^+}</m><nbsp /> <term>converges to A</term> if and only if for every <m>\epsilon\gt 0</m> there is some sufficiently large <m>N</m> such that <m>\abs{a_n - A}\lt \epsilon</m> whenever <m>n\gt N</m>.
            </statement>
        </definition>
        <p>
            Generally speaking, mathematical algorithms will have certain <term>input</term> and <term>output</term>; when we write an algorithm as a function, the arguments to the function are its inputs and the value it returns (along with any displayed intermediate results) are its output.
        </p>
        <algorithm xml:id="alg-interval_bisection">
            <idx><h>root</h><h>interval bisection method</h></idx>
            <idx><h>algorithm</h><h>root-finding by interval bisection</h></idx>
            <title>Root-finding by interval bisection method</title>
            <shorttitle>Interval bisection method</shorttitle>
            <statement>
                <p>
                    Suppose <m>f:\R\to\R</m> is a function which is continuous on the closed interval <m>[a,b]</m> and satisfies <m>f(a)\lt 0\lt f(b)</m>.
                </p>
                <ol label="1.">
                    <li>
                        Decide on a level of tolerance <m>\delta \gt 0</m>. When a subinterval midpoint is at most <m>\delta</m> from a root <m>x_0</m> of <m>f</m>, we will use that midpoint as our approximation.
                    </li>
                    <li>
                        <idx>ceiling</idx>
                        Define <m>w = b-a</m>, and calculate <m>r = \left\lceil\log_2\left(\frac{w}{\delta}\right)\right\rceil.</m> 
                        Then <m>2^r \geq \frac{w}{\delta}</m> so that <m>\frac{w}{2^r}\leq\delta</m> as desired.
                    </li>
                    <li>
                        Let <m>a_0 = a</m>, <m>b_0 = b</m>, and <m>m_0 = (a_0+b_0)/2</m>.
                    </li>
                    <li>
                        <p>
                            For each <m>i\in\set{1,2,\dotsc,r}</m>, do the following:
                        </p>
                        <ol label="1.">
                            <li>
                                If <m>f(m_{i-1})=0</m>, <m>m_{i-1}</m> is a root of <m>f</m> in the interval <m>(a,b)</m>. Return <m>m_{i-1}</m>.
                            </li>
                            <li>
                                If <m>f(m_{i-1})\gt 0</m>, let <m>a_i = a_{i-1}</m>, <m>b_i = m_{i-1}</m>, and <m>m_i = (a_i+b_i)/2</m>.
                            </li>
                            <li>
                                If <m>f(m_{i-1})\lt 0</m>, let <m>a_i = m_{i-1}</m>, <m>b_i = b_{i-1}</m>, and <m>m_i = (a_i+b_i)/2</m>.
                            </li>
                        </ol>
                    </li>
                    <li>
                        Unless a true root has previously been found (<m>f(m_i)=0</m> for some <m>i</m>), return <m>m_r</m> as the approximate root of the function <m>f</m>.
                    </li>
                </ol>
            </statement>
        </algorithm>
        <p>
            There are two disadvantages to this method: it has a bias in that it will tend to find roots in the subinterval <m>(a,\frac{a+b}2)</m> rather than in <m>(\frac{a+b}2,b)</m> when both exist, and also you must provide two endpoints between which a change of sign occurs.
        </p>
        <exercise>
            <statement>
                Consider the function <m>f(x) = x^3+2</m> on the interval <m>[-2,2]</m>.
                <sage>
                    <input>
                        x = var('x')
                        plot(x^3+2,(x,-2,2))
                    </input>
                </sage>
                Apply the interval bisection method to approximate the root of <m>f</m> in the interval <m>[-2,2]</m> to a tolerance of <m>\delta = 10^{-6}</m>.
            </statement>
        </exercise>
        <exercise>
            <statement>
                Consider the function <m>f(x) = 1+\sin x</m> on the interval <m>[-2\pi,2\pi]</m>. 
                <sage>
                    <input>
                        x = var('x')
                        plot(1+sin(x), (x,-2*pi,2*pi))
                    </input>
                </sage>
                Can we apply the method of interval bisection to find any of the roots of <m>f</m>?
            </statement>
        </exercise>
    </subsection>
    
</section>