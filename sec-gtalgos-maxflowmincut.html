<!DOCTYPE html>
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<html lang="en-US" dir="ltr">
<head xmlns:og="http://ogp.me/ns#" xmlns:book="https://ogp.me/ns/book#">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Maximizing flow</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:type" content="book">
<meta property="book:title" content="AAM: Algorithms for Applied Mathematics">
<meta property="book:author" content="Stephen J. Graves">
<script>
var runestoneMathReady = new Promise((resolve) => window.rsMathReady = resolve);
window.MathJax = {
  "tex": {
    "inlineMath": [
      [
        "\\(",
        "\\)"
      ]
    ],
    "tags": "none",
    "tagSide": "right",
    "tagIndent": ".8em",
    "packages": {
      "[+]": [
        "base",
        "extpfeil",
        "ams",
        "amscd",
        "color",
        "newcommand",
        "knowl"
      ]
    }
  },
  "options": {
    "ignoreHtmlClass": "tex2jax_ignore|ignore-math",
    "processHtmlClass": "process-math"
  },
  "chtml": {
    "scale": 0.98,
    "mtextInheritFont": true
  },
  "loader": {
    "load": [
      "input/asciimath",
      "[tex]/extpfeil",
      "[tex]/amscd",
      "[tex]/color",
      "[tex]/newcommand",
      "[pretext]/mathjaxknowl3.js"
    ],
    "paths": {
      "pretext": "_static/pretext/js/lib"
    }
  },
  "startup": {
    pageReady() {
      return MathJax.startup.defaultPageReady().then(function () {
      console.log("in ready function");
      rsMathReady();
      }
    )}
  }
};
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/themes/prism.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/components/prism-core.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/autoloader/prism-autoloader.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/line-numbers/prism-line-numbers.min.js" integrity="sha512-dubtf8xMHSQlExGRQ5R7toxHLgSDZ0K7AunqPWHXmJQ8XyVIG19S1T95gBxlAeGOK02P4Da2RTnQz0Za0H0ebQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/line-numbers/prism-line-numbers.min.css" integrity="sha512-cbQXwDFK7lj2Fqfkuxbo5iD1dSbLlJGXGpfTDqbggqjHJeyzx88I3rfwjS38WJag/ihH7lzuGlGHpDBymLirZQ==" crossorigin="anonymous" referrerpolicy="no-referrer">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/line-highlight/prism-line-highlight.min.css" integrity="sha512-nXlJLUeqPMp1Q3+Bd8Qds8tXeRVQscMscwysJm821C++9w6WtsFbJjPenZ8cQVMXyqSAismveQJc0C1splFDCA==" crossorigin="anonymous" referrerpolicy="no-referrer">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/line-highlight/prism-line-highlight.min.js" integrity="sha512-93uCmm0q+qO5Lb1huDqr7tywS8A2TFA+1/WHvyiWaK6/pvsFl6USnILagntBx8JnVbQH5s3n0vQZY6xNthNfKA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js" integrity="sha512-4xUl/d6D6THrAnXAwGajXkoWaeMNwEKK4iNfq5DotEbLPAfk6FSxSP3ydNxqDgCw1c/0Z1Jg6L8h2j+++9BZmg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="lunr-pretext-search-index.js" async=""></script><script src="_static/pretext/js/pretext_search.js"></script><link href="_static/pretext/css/pretext_search.css" rel="stylesheet" type="text/css">
<script src="_static/pretext/js/lib/jquery.min.js"></script><script src="_static/pretext/js/lib/jquery.sticky.js"></script><script src="_static/pretext/js/lib/jquery.espy.min.js"></script><script src="_static/pretext/js/pretext.js"></script><script src="_static/pretext/js/pretext_add_on.js?x=1"></script><script src="_static/pretext/js/user_preferences.js"></script><script src="_static/pretext/js/lib/knowl.js"></script><!--knowl.js code controls Sage Cells within knowls--><script>sagecellEvalName='Evaluate (Sage)';
</script><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@400;700&amp;family=Noto+Serif:ital,wght@0,400;0,700;1,400;1,700&amp;family=Tinos:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet">
<link href="https://fonts.cdnfonts.com/css/dejavu-serif" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Roboto+Serif:opsz,wdth,wght@8..144,50..150,100..900&amp;display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Open+Sans:wdth,wght@75..100,300..800&amp;display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200">
<link href="_static/pretext/css/pretext.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/pretext_add_on.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/shell_default.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/banner_default.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/navbar_default.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/toc_default.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/knowls_default.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/style_default.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/colors_pastel_blue_orange.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/setcolors.css" rel="stylesheet" type="text/css">
</head>
<body class="pretext book ignore-math">
<a class="assistive" href="#ptx-content">Skip to main content</a><header id="ptx-masthead" class="ptx-masthead"><div class="ptx-banner">
<a id="logo-link" class="logo-link" target="_blank" href=""></a><div class="title-container">
<h1 class="heading"><a href="AAM.html"><span class="title">AAM: Algorithms for Applied Mathematics</span></a></h1>
<p class="byline">Stephen J. Graves</p>
</div>
</div></header><nav id="ptx-navbar" class="ptx-navbar navbar"><button class="toc-toggle button" title="Contents"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5d2;</span><span class="name">Contents</span></button><div class="searchbox">
<div class="searchwidget"><button id="searchbutton" class="searchbutton button" type="button" title="Search book"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe8b6;</span><span class="name">Search Book</span></button></div>
<div id="searchresultsplaceholder" class="searchresultsplaceholder" style="display: none">
<div class="search-results-controls">
<input aria-label="Search term" id="ptxsearch" class="ptxsearch" type="text" name="terms" placeholder="Search term"><button title="Close search" id="closesearchresults" class="closesearchresults"><span class="material-symbols-outlined">close</span></button>
</div>
<h2 class="search-results-heading">Search Results: </h2>
<div id="searchempty" class="searchempty"><span>No results.</span></div>
<ol id="searchresults" class="searchresults"></ol>
</div>
</div>
<span class="nav-other-controls"></span><span class="treebuttons"><a class="previous-button button" href="sec-gtalgos-shortestpath.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="up-button button" href="ch-gtalgos.html" title="Up"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Up</span></a><a class="next-button button" href="aam-backmatter.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a></span></nav><div id="latex-macros" class="hidden-content process-math" style="display:none"><span class="process-math">\(\usepackage{mathtools}
\DeclareMathOperator{\fixedset}{fix}
\DeclareMathOperator{\support}{supp}
\DeclareMathOperator{\lcm}{lcm}

\newcommand{\set}[1]{\left\{#1\right\}}
\newcommand{\upto}[1]{\set{0,1,\dotsc,#1-1}}
\newcommand{\seq}[1]{\left(#1\right)}
\newcommand{\abs}[1]{\left|#1\right|}
\newcommand{\floor}[1]{\left\lfloor#1\right\rfloor}
\newcommand{\ceil}[1]{\left\lceil#1\right\rceil}
\newcommand{\after}{\circ}
\newcommand{\sym}[1]{\mathcal{S}_{#1}}
\newcommand{\fix}[1]{\fixedset{#1}}
\newcommand{\supp}[1]{\support{#1}}
\newcommand{\xto}[1]{\xrightarrow{#1}}
\newcommand{\arr}[1]{\overrightarrow{#1}}

\newcommand{\rem}{\%}
\newcommand{\divides}{\mid}
\newcommand{\Nats}{\mathbb{N}}
\newcommand{\Ints}{\mathbb{Z}}
\newcommand{\Zp}{\Ints^+}
\newcommand{\Rats}{\mathbb{Q}}
\newcommand{\Reals}{\mathbb{R}}
\newcommand{\Comps}{\mathbb{C}}
\newcommand{\Mats}[1]{\mathbb{M}_{#1}}
\renewcommand{\vec}[1]{\mathbf{#1}}
\newcommand{\cvec}[1]{\begin{bmatrix}#1\end{bmatrix}}
\newcommand{\vv}{\vec{v}}
\newcommand{\CV}[1]{\Comps^{#1}}
\newcommand{\entry}[2]{\left[#1\right]_{#2}}
\newcommand{\hip}[2]{\left\langle#1,#2\right\rangle}
\newcommand{\conj}[1]{\overline{#1}}

\newcommand{\dist}[3]{d_{#1}\left(#2,#3\right)}
\newcommand{\norm}[1]{\left\|#1\right\|}
\DeclareMathOperator{\spn}{span}
\newcommand{\spanset}[1]{\spn #1}
\DeclareMathOperator{\Aut}{Aut}
\newcommand{\rswap}[2]{R_{#1}\leftrightarrow R_{#2}}
\newcommand{\rscale}[2]{\left(#1\right) R_{#2}}
\newcommand{\relim}[3]{\left(#1\right) R_{#2}+R_{#3}}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\definecolor{fillinmathshade}{gray}{0.9}
\newcommand{\fillinmath}[1]{\mathchoice{\colorbox{fillinmathshade}{$\displaystyle     \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\textstyle        \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptstyle      \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptscriptstyle\phantom{\,#1\,}$}}}
\)</span></div>
<div class="ptx-page">
<div id="ptx-sidebar" class="ptx-sidebar"><nav id="ptx-toc" class="ptx-toc depth2"><ul class="structural contains-active toc-item-list">
<li class="toc-item toc-frontmatter">
<div class="toc-title-box"><a href="frontmatter.html" class="internal"><span class="title">Front Matter</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-colophon"><div class="toc-title-box"><a href="AAM-fm-col.html" class="internal"><span class="title">Colophon</span></a></div></li>
<li class="toc-item toc-acknowledgement"><div class="toc-title-box"><a href="AAM-fm-ack.html" class="internal"><span class="title">Acknowledgements</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-intro.html" class="internal"><span class="codenumber">1</span> <span class="title">Welcome!</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-intro-mst.html" class="internal"><span class="codenumber">1.1</span> <span class="title">Connecting a network</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-mst.html#subsec-intro-mst-example" class="internal"><span class="codenumber">1.1.1</span> <span class="title">Working from an example</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-mst.html#subsec-intro-mst-algorithm" class="internal"><span class="codenumber">1.1.2</span> <span class="title">Algorithm</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-intro-kidrsa.html" class="internal"><span class="codenumber">1.2</span> <span class="title">Familiarity with Python</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-perms.html" class="internal"><span class="codenumber">2</span> <span class="title">Permutations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-perms-def.html" class="internal"><span class="codenumber">2.1</span> <span class="title">Mathematical permutations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-perms-def.html#sub-perms-def-linenotations" class="internal"><span class="codenumber">2.1.1</span> <span class="title">One-line and two-line notations</span></a></div></li>
<li class="toc-item toc-subsection">
<div class="toc-title-box"><a href="sec-perms-def.html#sub-perms-def-groups" class="internal"><span class="codenumber">2.1.2</span> <span class="title">Permutation groups</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsubsection"><div class="toc-title-box"><a href="sec-perms-def.html#subsub-perms-def-groups-products" class="internal"><span class="codenumber">2.1.2.1</span> <span class="title">Calculating permutation products</span></a></div></li>
<li class="toc-item toc-subsubsection"><div class="toc-title-box"><a href="sec-perms-def.html#subsub-perms-def-groups-multprops" class="internal"><span class="codenumber">2.1.2.2</span> <span class="title">Properties of permutation multiplication</span></a></div></li>
<li class="toc-item toc-subsubsection"><div class="toc-title-box"><a href="sec-perms-def.html#subsub-perms-def-groups-absalg" class="internal"><span class="codenumber">2.1.2.3</span> <span class="title">Abstract algebra and permutation groups</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-perms-def.html#sub-perms-def-cycles" class="internal"><span class="codenumber">2.1.3</span> <span class="title">Cycles and disjoint cycle decomposition</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-perms-oop.html" class="internal"><span class="codenumber">2.2</span> <span class="title">Permutations in Python</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-perms-oop.html#sec-perms-oop_classes" class="internal"><span class="codenumber">2.2.1</span> <span class="title">Classes</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-perms-oop.html#sub-perms-oop_instantiation" class="internal"><span class="codenumber">2.2.2</span> <span class="title">Creating new objects</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-perms-oop.html#sub-perms-oop_validation" class="internal"><span class="codenumber">2.2.3</span> <span class="title">Input validation</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-perms-oop.html#sub-perms-oop_adding_methods" class="internal"><span class="codenumber">2.2.4</span> <span class="title">Additional methods</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-crypto.html" class="internal"><span class="codenumber">3</span> <span class="title">Simple Cryptography</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-crypto-subst.html" class="internal"><span class="codenumber">3.1</span> <span class="title">Simple substitution ciphers</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-crypto-subst.html#sub-crypto-subst-simple" class="internal"><span class="codenumber">3.1.1</span> <span class="title">Monoalphabetic substitution</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-crypto-subst.html#sub-crypto-subst-freqanalysis" class="internal"><span class="codenumber">3.1.2</span> <span class="title">Frequency analysis</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-crypto-classic.html" class="internal"><span class="codenumber">3.2</span> <span class="title">Other classical ciphers</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-crypto-classic.html#sub-crypto-classic-digraphs" class="internal"><span class="codenumber">3.2.1</span> <span class="title">Increasing the alphabet: Playfair’s cipher</span></a></div></li>
<li class="toc-item toc-subsection">
<div class="toc-title-box"><a href="sec-crypto-classic.html#sub-crypto-classic-poly" class="internal"><span class="codenumber">3.2.2</span> <span class="title">Polyalphabetic substitution</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsubsection"><div class="toc-title-box"><a href="sec-crypto-classic.html#ssub-crypto-classic-tabularecta" class="internal"><span class="codenumber">3.2.2.1</span> <span class="title">The tabula recta</span></a></div></li>
<li class="toc-item toc-subsubsection"><div class="toc-title-box"><a href="sec-crypto-classic.html#ssub-crypto-classic-vigenere" class="internal"><span class="codenumber">3.2.2.2</span> <span class="title">Vigenère ciphers and the index of coincidence</span></a></div></li>
<li class="toc-item toc-subsubsection"><div class="toc-title-box"><a href="sec-crypto-classic.html#ssub-crypto-classic-onetimepad" class="internal"><span class="codenumber">3.2.2.3</span> <span class="title">One-time pads</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-crypto-classic.html#sub-crypto-classic-enigma" class="internal"><span class="codenumber">3.2.3</span> <span class="title">The Enigma cipher</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-crypto-proj.html" class="internal"><span class="codenumber">3.3</span> <span class="title">Crypto in Python</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-crypto-proj.html#sub-crypto-proj-manual_decryption" class="internal"><span class="codenumber">3.3.1</span> <span class="title">Demonstrating understanding</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-crypto-proj.html#sub-crypto-proj-implementations" class="internal"><span class="codenumber">3.3.2</span> <span class="title">Implementing cryptography</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-linalg.html" class="internal"><span class="codenumber">4</span> <span class="title">Linear Algebra</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-linalg-vectors.html" class="internal"><span class="codenumber">4.1</span> <span class="title">Vectors</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-linalg-vectors.html#sub-linalg-vectors-axioms" class="internal"><span class="codenumber">4.1.1</span> <span class="title">Vector space axioms</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-linalg-vectors.html#sub-linalg-vectors-colvecs" class="internal"><span class="codenumber">4.1.2</span> <span class="title">Column vectors</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-linalg-vectors.html#sub-linalg-vectors-lintrans" class="internal"><span class="codenumber">4.1.3</span> <span class="title">Linear transformations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-linalg-vectors.html#sub-linalg-vectors-inner_prods" class="internal"><span class="codenumber">4.1.4</span> <span class="title">Inner product spaces</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-linalg-vecproj.html" class="internal"><span class="codenumber">4.2</span> <span class="title">Vectors in Python</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-linalg-vecproj.html#sub-vecproj-init_and_repr" class="internal"><span class="codenumber">4.2.1</span> <span class="title">Getting started with initialization and representation</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-linalg-vecproj.html#sub-vecproj-add_and_mul" class="internal"><span class="codenumber">4.2.2</span> <span class="title">Vector addition and scalar multiplication</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-linalg-vecproj.html#sub-vecproj-extras" class="internal"><span class="codenumber">4.2.3</span> <span class="title">Additional class methods</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-linalg-vecproj.html#sub-vecproj-computations" class="internal"><span class="codenumber">4.2.4</span> <span class="title">“Simple” computations</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-linalg-matrices.html" class="internal"><span class="codenumber">4.3</span> <span class="title">Complex matrices</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-linalg-matrices.html#sub-linalg-matrices-matrix_vector_product" class="internal"><span class="codenumber">4.3.1</span> <span class="title">Matrix-vector products</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-linalg-matrices.html#sub-linalg-matrices-matrix_matrix_product" class="internal"><span class="codenumber">4.3.2</span> <span class="title">Matrix-matrix products</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-linalg-matproj.html" class="internal"><span class="codenumber">4.4</span> <span class="title">Matrices in Python</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-linalg-matproj.html#sub-linalg-matproj-basics" class="internal"><span class="codenumber">4.4.1</span> <span class="title"><code class="code-inline tex2jax_ignore">AlgoMatrix</code> basics</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-linalg-matproj.html#sub-linalg-matproj-named_methods" class="internal"><span class="codenumber">4.4.2</span> <span class="title">Named <code class="code-inline tex2jax_ignore">AlgoMatrix</code> methods</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-matrix-apps.html" class="internal"><span class="codenumber">5</span> <span class="title">Matrix Applications</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-matapps-ssles.html" class="internal"><span class="codenumber">5.1</span> <span class="title">Solving Systems of Linear Equations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-matapps-ssles.html#sub-matapps-sles-rowops" class="internal"><span class="codenumber">5.1.1</span> <span class="title">Elementary row operations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-matapps-ssles.html#sub-matapps-sles-row_equivalence" class="internal"><span class="codenumber">5.1.2</span> <span class="title">Row equivalence and solutions to SLEs</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-matapps-gje_proj.html" class="internal"><span class="codenumber">5.2</span> <span class="title">GJE in Python</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-matapps-gje_proj.html#sub-matapps-gje_np" class="internal"><span class="codenumber">5.2.1</span> <span class="title">Gauss-Jordan elimination with naive pivoting</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-matapps-gje_proj.html#sub-matapps-gje_naive_flaw" class="internal"><span class="codenumber">5.2.2</span> <span class="title">Swamping: the computational flaw in naive pivoting</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-matapps-gje_proj.html#sub-matapps-gje_pp" class="internal"><span class="codenumber">5.2.3</span> <span class="title">Gauss-Jordan elimination with partial pivoting</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-matapps-gje_proj.html#sub-matapps-implement_gje_pp" class="internal"><span class="codenumber">5.2.4</span> <span class="title">Implementing GJE with PP</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-matapps-ludecomp.html" class="internal"><span class="codenumber">5.3</span> <span class="title"><span class="process-math">\(PA=LU\)</span> Decomposition</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-matapps-ludecomp.html#sub-matapps-ludecomp-theory" class="internal"><span class="codenumber">5.3.1</span> <span class="title">Special factors</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-matapps-ludecomp.html#sub-matapps-ludecomp-solving" class="internal"><span class="codenumber">5.3.2</span> <span class="title">Solving systems via <span class="process-math">\(LU\)</span> decomposition</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-matapps-ludecomp.html#sub-matapps-ludecomp-algo" class="internal"><span class="codenumber">5.3.3</span> <span class="title">Algorithms for <span class="process-math">\(LU\)</span> decomposition</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter contains-active">
<div class="toc-title-box"><a href="ch-gtalgos.html" class="internal"><span class="codenumber">6</span> <span class="title">Graph Theory Algorithms</span></a></div>
<ul class="structural toc-item-list contains-active">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-gtalgos-basics.html" class="internal"><span class="codenumber">6.1</span> <span class="title">Graph basics</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-gtalgos-mst.html" class="internal"><span class="codenumber">6.2</span> <span class="title">Minimum spanning trees</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-gtalgos-mst.html#sub-gtalgos-mst-jarnik_prim" class="internal"><span class="codenumber">6.2.1</span> <span class="title">Jarník-Prim Algorithm</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-gtalgos-mst.html#sub-gtalgos-mst-minheaps" class="internal"><span class="codenumber">6.2.2</span> <span class="title">Min Heaps</span></a></div></li>
<li class="toc-item toc-subsection">
<div class="toc-title-box"><a href="sec-gtalgos-mst.html#sub-gtalgos-mst-kruskal" class="internal"><span class="codenumber">6.2.3</span> <span class="title">Kruskal’s algorithm</span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-subsubsection"><div class="toc-title-box"><a href="sec-gtalgos-mst.html#sub-gtalgos-mst-kruskal-3" class="internal"><span class="codenumber">6.2.3.1</span> <span class="title">Implementing Kruskal’s algorithm</span></a></div></li></ul>
</li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-gtalgos-shortestpath.html" class="internal"><span class="codenumber">6.3</span> <span class="title">Shortest Paths</span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-subsection">
<div class="toc-title-box"><a href="sec-gtalgos-shortestpath.html#sub-gtalgos-shortestpath-dijkstra" class="internal"><span class="codenumber">6.3.1</span> <span class="title">Dijkstra’s Algorithm</span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-subsubsection"><div class="toc-title-box"><a href="sec-gtalgos-shortestpath.html#sub-gtalgos-shortestpath-dijkstra-3" class="internal"><span class="codenumber">6.3.1.1</span> <span class="title">A full example of Dijkstra’s algorithm</span></a></div></li></ul>
</li></ul>
</li>
<li class="toc-item toc-section active">
<div class="toc-title-box"><a href="sec-gtalgos-maxflowmincut.html" class="internal"><span class="codenumber">6.4</span> <span class="title">Maximizing flow</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-gtalgos-maxflowmincut.html#sec-MaxFlow-MaxFlow" class="internal"><span class="codenumber">6.4.1</span> <span class="title">Max flow</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-gtalgos-maxflowmincut.html#sec-MaxFlow-DinitzAlgo" class="internal"><span class="codenumber">6.4.2</span> <span class="title">Dinitz’ Algorithm</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-gtalgos-maxflowmincut.html#sec-MaxFlow-DinitzImpl" class="internal"><span class="codenumber">6.4.3</span> <span class="title">Implementing Dinitz’ Algorithm</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-backmatter">
<div class="toc-title-box"><a href="aam-backmatter.html" class="internal"><span class="title">Back Matter</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-appendix">
<div class="toc-title-box"><a href="app-python.html" class="internal"><span class="codenumber">A</span> <span class="title">Python crash course</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-intro-idle.html" class="internal"><span class="codenumber">A.1</span> <span class="title">Getting started with Python</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-idle.html#sub-intro-idle-gettingidle" class="internal"><span class="codenumber">A.1.1</span> <span class="title">Getting IDLE</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-idle.html#sub-intro-idle-interactivemode" class="internal"><span class="codenumber">A.1.2</span> <span class="title">Interactive Mode</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-idle.html#sub-intro-idle-firstprogram" class="internal"><span class="codenumber">A.1.3</span> <span class="title">A first Python module</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-intro_basicdata.html" class="internal"><span class="codenumber">A.2</span> <span class="title">Basic data types</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro_basicdata.html#sub-intro-basicdata-numbers" class="internal"><span class="codenumber">A.2.1</span> <span class="title">Numerical data types</span></a></div></li>
<li class="toc-item toc-subsection">
<div class="toc-title-box"><a href="sec-intro_basicdata.html#sub-intro-basicdata-other" class="internal"><span class="codenumber">A.2.2</span> <span class="title">Non-numeric data types</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsubsection"><div class="toc-title-box"><a href="sec-intro_basicdata.html#subsub-intro-basicdata-other-bool" class="internal"><span class="codenumber">A.2.2.1</span> <span class="title">Boolean variables</span></a></div></li>
<li class="toc-item toc-subsubsection"><div class="toc-title-box"><a href="sec-intro_basicdata.html#subsub-intro-basicdata-other-str" class="internal"><span class="codenumber">A.2.2.2</span> <span class="title">Strings</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-intro-containers.html" class="internal"><span class="codenumber">A.3</span> <span class="title">Container data types</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection">
<div class="toc-title-box"><a href="sec-intro-containers.html#sub-intro-containers-lists" class="internal"><span class="codenumber">A.3.1</span> <span class="title">The <code class="code-inline tex2jax_ignore">list</code> data type</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsubsection"><div class="toc-title-box"><a href="sec-intro-containers.html#subsub-intro-containers-lists-slices" class="internal"><span class="codenumber">A.3.1.1</span> <span class="title">Indexing and slicing</span></a></div></li>
<li class="toc-item toc-subsubsection"><div class="toc-title-box"><a href="sec-intro-containers.html#subsub-intro-containers-lists-ops_meths" class="internal"><span class="codenumber">A.3.1.2</span> <span class="title">Operators and methods</span></a></div></li>
<li class="toc-item toc-subsubsection"><div class="toc-title-box"><a href="sec-intro-containers.html#subsub-intro-containers-lists-mutable" class="internal"><span class="codenumber">A.3.1.3</span> <span class="title">Mutability</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-containers.html#sub-intro-containers-tuples" class="internal"><span class="codenumber">A.3.2</span> <span class="title">The <code class="code-inline tex2jax_ignore">tuple</code> data type</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-containers.html#sub-intro-containers-dicts" class="internal"><span class="codenumber">A.3.3</span> <span class="title">The <code class="code-inline tex2jax_ignore">dict</code> data type</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-containers.html#sec-intro-containers-6" class="internal"><span class="codenumber">A.3.4</span> <span class="title">Sets are a special container</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-intro-iteration.html" class="internal"><span class="codenumber">A.4</span> <span class="title">Iteration</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-iteration.html#sub-intro-iteration-for" class="internal"><span class="codenumber">A.4.1</span> <span class="title">For loops</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-iteration.html#sub-intro-iteration-while" class="internal"><span class="codenumber">A.4.2</span> <span class="title">While loops</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-intro-functions.html" class="internal"><span class="codenumber">A.5</span> <span class="title">Functions and conditional statements</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-functions.html#sub-intro-functions-def" class="internal"><span class="codenumber">A.5.1</span> <span class="title"><code class="code-inline tex2jax_ignore">def</code>ining new functions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-functions.html#subsec-into-functions-conditionals" class="internal"><span class="codenumber">A.5.2</span> <span class="title">Controlling flow of programs</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-functions.html#sub-intro-functions-collatz" class="internal"><span class="codenumber">A.5.3</span> <span class="title">The Collatz Conjecture</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-intro-errors.html" class="internal"><span class="codenumber">A.6</span> <span class="title">Errors and exception handling</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-errors.html#sub-intro-errors-exceptions" class="internal"><span class="codenumber">A.6.1</span> <span class="title">Exceptions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-errors.html#sub-intro-errors-handling" class="internal"><span class="codenumber">A.6.2</span> <span class="title">Handling exceptions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-errors.html#sub-intro-errors-flow" class="internal"><span class="codenumber">A.6.3</span> <span class="title">Controlling the flow of a program</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-errors.html#sub-intro-errors-bugs" class="internal"><span class="codenumber">A.6.4</span> <span class="title">Semantic errors, or bugs</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-appendix">
<div class="toc-title-box"><a href="appendix-lists.html" class="internal"><span class="codenumber">B</span> <span class="title">Finding ideas quickly</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="app-find-defs.html" class="internal"><span class="codenumber">B.1</span> <span class="title">Definitions</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="app-find-tech.html" class="internal"><span class="codenumber">B.2</span> <span class="title">Technology and Algorithms</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="app-find-results.html" class="internal"><span class="codenumber">B.3</span> <span class="title">Lemmas, Propositions, and Theorems</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="app-find-projects.html" class="internal"><span class="codenumber">B.4</span> <span class="title">Projects</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-appendix"><div class="toc-title-box"><a href="appendix-gfdl.html" class="internal"><span class="codenumber">C</span> <span class="title">GNU Free Documentation License</span></a></div></li>
<li class="toc-item toc-colophon"><div class="toc-title-box"><a href="aam-backmatter-4.html" class="internal"><span class="title">Colophon</span></a></div></li>
</ul>
</li>
</ul></nav></div>
<main class="ptx-main"><div id="ptx-content" class="ptx-content"><section class="section" id="sec-gtalgos-maxflowmincut"><h2 class="heading hide-type">
<span class="type">Section</span><span class="space"> </span><span class="codenumber">6.4</span><span class="space"> </span><span class="title">Maximizing flow</span>
</h2>
<section class="introduction" id="sec-gtalgos-maxflowmincut-2"><h3 class="heading">Capacitated networks.<span></span>
</h3> <div class="para" id="sec-gtalgos-maxflowmincut-2-2">All information flows over some sort of network, whether it be electronic or otherwise; you can think of communicating person-to-person as a pair of nodes and a regular graph edge connecting them, while a person lecturing to a group might be modeled more accurately by a hypergraph<details class="ptx-footnote" aria-live="polite" id="sec-gtalgos-maxflowmincut-2-2-1"><summary class="ptx-footnote__number" title="Footnote 2"><sup> 2 </sup></summary><div class="ptx-footnote__contents" id="sec-gtalgos-maxflowmincut-2-2-1">Remember that a <em class="emphasis">hypergraph</em> permits edges to contain more than two vertices.</div></details>. Similarly, the logistic problem of transporting goods and services across the country can be modeled using a transportation network.</div> <div class="para" id="sec-gtalgos-maxflowmincut-2-3">In both of these cases, there is a sort of maximum capacity for the transfer, and this gives us the concept of a <em class="emphasis">capacitated network.</em> This is much like a weighted graph, but we tend to think of networks as directed. Additionally we must consider that not ever connection in a network can be utilized to its full capacity at all times; hence we have two numbers associated with each edge, the <em class="emphasis">flow</em> and the <em class="emphasis">capacity</em>.</div> <div class="para" id="sec-gtalgos-maxflowmincut-2-4">A capacitated network also has two special vertices: the <em class="emphasis">source</em>, <span class="process-math">\(s\text{,}\)</span> and <em class="emphasis">target</em> (or sink), <span class="process-math">\(t\text{.}\)</span> The flow begins form the source and terminates at the sink — a flow is valid if and only if the flow into each vertex is equal to the flow out of the vertex, with exceptions at <span class="process-math">\(s\)</span> and <span class="process-math">\(t\text{,}\)</span> and the flow across each directed edge is less than or equal to the capacity of that edge.</div></section><section class="subsection" id="sec-MaxFlow-MaxFlow"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">6.4.1</span><span class="space"> </span><span class="title">Max flow</span>
</h3>
<div class="para" id="sec-MaxFlow-MaxFlow-2">In nearly every application, the desire is to maximize the flow from <span class="process-math">\(s\)</span> to <span class="process-math">\(t\)</span> across the network; since what is flowing across most networks is not a physical fluid, the problem of maximizing flow is discrete-mathematical rather than a problem of physics solved by differential equations.</div>
<article class="definition definition-like" id="sec-MaxFlow-MaxFlow-3"><h4 class="heading">
<span class="type">Definition</span><span class="space"> </span><span class="codenumber">6.4.1</span><span class="period">.</span>
</h4>
<div class="para logical" id="sec-MaxFlow-MaxFlow-3-1-1">
<div class="para">Suppose <span class="process-math">\(\Delta = (V,E,s,t)\)</span> is a directed graph with <dfn class="terminology">source vertex</dfn> <span class="process-math">\(s\)</span> and <dfn class="terminology">target vertex</dfn> <span class="process-math">\(t\text{.}\)</span> A <dfn class="terminology">capacity function</dfn> <span class="process-math">\(c:E\to\Reals^+\)</span> for <span class="process-math">\(\Delta\)</span> is the maximum amount of flow which can pass across an edge; this is denoted <span class="process-math">\(c(u,v)\)</span> for the directed edge <span class="process-math">\(uv\in E\text{.}\)</span> A <dfn class="terminology">flow function</dfn> <span class="process-math">\(f:E\to \Reals^+\)</span> for <span class="process-math">\(\Delta\)</span> is a function satisfying the following two constraints:</div>
<ol class="decimal">
<li id="sec-MaxFlow-MaxFlow-3-1-1-14-1"><div class="para" id="sec-MaxFlow-MaxFlow-3-1-1-14-1-1">(Capacity Constraint) <span class="process-math">\(f(u,v) \leq c(u,v)\)</span> for all <span class="process-math">\(uv\in E\text{,}\)</span> and</div></li>
<li id="sec-MaxFlow-MaxFlow-3-1-1-14-2"><div class="para logical" id="sec-MaxFlow-MaxFlow-3-1-1-14-2-1">
<div class="para">(Conservation of Flow) for each <span class="process-math">\(v\in V\setminus\set{s,t}\text{,}\)</span>
</div>
<div class="displaymath process-math">
\begin{equation*}
\sum_{uv\in E}f(u,v) = \sum_{vu\in E}f(v,u).
\end{equation*}
</div>
</div></li>
</ol>
</div> <div class="para logical" id="sec-MaxFlow-MaxFlow-3-1-2">
<div class="para">The <dfn class="terminology">value of flow</dfn> for a flow function <span class="process-math">\(f\)</span> is defined by</div>
<div class="displaymath process-math">
\begin{equation*}
\abs{f} = \sum_{v\in V}f(s,v) .
\end{equation*}
</div>
</div> <div class="para" id="sec-MaxFlow-MaxFlow-3-1-3">Generally, we wish to maximize the value <span class="process-math">\(\abs{f}\)</span> over all possible flows.</div></article><article class="definition definition-like" id="sec-MaxFlow-MaxFlow-4"><h4 class="heading">
<span class="type">Definition</span><span class="space"> </span><span class="codenumber">6.4.2</span><span class="period">.</span>
</h4>
<div class="para logical" id="sec-MaxFlow-MaxFlow-4-1-1">
<div class="para">Suppose <span class="process-math">\(\Delta = (V,E,c,s,t)\)</span> is a capacitated network with source <span class="process-math">\(s\)</span> and target <span class="process-math">\(t\text{.}\)</span> An <span class="process-math">\(s-t cut\)</span> is a partition <span class="process-math">\(C=(S,T)\)</span> such that <span class="process-math">\(s\in S\)</span> and <span class="process-math">\(t\in T\text{.}\)</span> The <dfn class="terminology">cut-set</dfn> of <span class="process-math">\(C\)</span> is the set of edges <span class="process-math">\(\set{uv\in E:u\in S, v\in T}\text{.}\)</span> We notice that if a flow of <span class="process-math">\(0\)</span> is put on all edges in the cur-set of <span class="process-math">\(C\text{,}\)</span> then <span class="process-math">\(\abs{f}=0\text{.}\)</span> The <dfn class="terminology">capacity</dfn> of the cut <span class="process-math">\(C=(S,T)\)</span> is</div>
<div class="displaymath process-math">
\begin{equation*}
c(S,T) = \sum_{\set{uv\in E: u\in S, v\in T}}c(u,v).
\end{equation*}
</div>
</div> <div class="para" id="sec-MaxFlow-MaxFlow-4-1-2">Just as it is interesting to determine a maximum flow over a network, there are applications when finding a minimum-capacity cut-set is desirable.</div></article><article class="theorem theorem-like" id="sec-MaxFlow-MaxFlow-5"><h4 class="heading">
<span class="type">Theorem</span><span class="space"> </span><span class="codenumber">6.4.3</span><span class="period">.</span><span class="space"> </span><span class="title">Max-flow Min-cut Theorem.</span>
</h4>
<div class="para" id="sec-MaxFlow-MaxFlow-5-2-1">The maximum value of a <span class="process-math">\(s\text{-}t\)</span> flow is equal to the minimum capacity of an <span class="process-math">\(s\text{-}t\)</span> cut.</div></article></section><section class="subsection" id="sec-MaxFlow-DinitzAlgo"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">6.4.2</span><span class="space"> </span><span class="title">Dinitz’ Algorithm</span>
</h3>
<div class="para" id="sec-MaxFlow-DinitzAlgo-2">The original solution to the problem of calculating a maximum flow was published in 1956 by L. R. Ford, Jr. and D. R. Fulkerson. The modified version presented here was produced by Yefim Dinitz as a “response to a pre-class exercise in (Georg) Adel’son-Vel’sky’s Algorithm class.” According to Dinitz, he was at the time unaware of the basic details of the Ford-Fulkerson algorithm upon which his algorithm improves.</div>
<div class="para" id="sec-MaxFlow-DinitzAlgo-3">Both algorithms proceed in this general fashion: given a flow, determine which edges have <dfn class="terminology">residual capacity.</dfn> In the residual graph, try to find a flow which can augment the current flow. When no such flow can be found, a maximum flow has been found.</div>
<div class="para" id="sec-MaxFlow-DinitzAlgo-4">The foremost reason an improvement was needed to the Ford-Fulkerson algorithm is its failure to terminate in certain cases of networks with irrational capacities. As the algorithm is successful in constructing a maximum flow whenever it terminates, an improvement to the algorithm was more likely than a replacement. Dinitz’ improvement utilized shortest paths to overcome the conceptual flaw in Ford-Fulkerson during the step of finding an augmenting path. Hence we will first discuss the modification to Dikstra’s algorithm which produces the necessary shortest path graph.</div>
<div class="para" id="sec-MaxFlow-DinitzAlgo-5">The modification to Dijkstra’s algorithm to construct a subgraph consisting of all shortest paths from <span class="process-math">\(s\)</span> to <span class="process-math">\(t\)</span> is conceptually deep but easy to implement. Suppose <span class="process-math">\(v\in V\)</span> with <span class="process-math">\(\dist{\Delta_f}{s}{v}=k\text{,}\)</span> where <span class="process-math">\(s\)</span> is the source vertex. Rather than recording a single <span class="process-math">\(s,v\)</span>-path, we records every vertex <span class="process-math">\(u\in V\)</span> such that <span class="process-math">\(\dist{\Delta_f}{s}{u}=k-1\)</span> and there is an arc<details class="ptx-footnote" aria-live="polite" id="sec-MaxFlow-DinitzAlgo-5-9"><summary class="ptx-footnote__number" title="Footnote 3"><sup> 3 </sup></summary><div class="ptx-footnote__contents" id="sec-MaxFlow-DinitzAlgo-5-9">Recall that we are working over directed graphs now.</div></details> from <span class="process-math">\(u\)</span> to <span class="process-math">\(v\text{.}\)</span>
</div>
<article class="algorithm theorem-like" id="alg_mod_dijkstra"><h4 class="heading">
<span class="type">Algorithm</span><span class="space"> </span><span class="codenumber">6.4.4</span><span class="period">.</span><span class="space"> </span><span class="title">Modified Dikstra: All Shortest Paths from <span class="process-math">\(s\)</span>.</span>
</h4>
<div class="para logical" id="alg_mod_dijkstra-2">
<div class="para">Suppose that <span class="process-math">\(\Delta_f=(V,E_f,c_f,s,t)\)</span> is a capacitated network with source vertex <span class="process-math">\(s\)</span> and target vertex <span class="process-math">\(t\text{.}\)</span>
</div>
<ol class="decimal">
<li id="alg_mod_dijkstra-2-4-1"><div class="para logical" id="alg_mod_dijkstra-2-4-1-1">
<div class="para">Initialize the distance and predecessor functions,</div>
<div class="displaymath process-math" id="alg_mod_dijkstra-2-4-1-1-1">
\begin{align*}
\dist{\Delta_f}{s}{v} \amp = \begin{cases}0, \amp  v=s \\ \infty, \amp v\neq s
\end{cases}
\amp
p(v) \amp = \set{}
\end{align*}
</div>
<div class="para">for each <span class="process-math">\(v\in V\text{.}\)</span> Also, define a set <span class="process-math">\(V'=\set{}\)</span> of visited vertices.</div>
</div></li>
<li id="alg_mod_dijkstra-2-4-2"><div class="para logical" id="alg_mod_dijkstra-2-4-2-1">
<div class="para">While <span class="process-math">\(\abs{V'}\lt \abs{V}\text{,}\)</span> repeat the following steps:</div>
<ol class="lower-alpha">
<li id="alg_mod_dijkstra-2-4-2-1-2-1"><div class="para logical" id="alg_mod_dijkstra-2-4-2-1-2-1-1">
<div class="para">Let <span class="process-math">\(u\in V\setminus V'\)</span> be an unvisited vertex nearest to <span class="process-math">\(s\text{;}\)</span> that is,</div>
<div class="displaymath process-math">
\begin{equation*}
\dist{\Delta_f}{s}{u}=\min\set{\dist{\Delta_f}{s}{v}:v\in V\setminus V'}.
\end{equation*}
</div>
</div></li>
<li id="alg_mod_dijkstra-2-4-2-1-2-2"><div class="para logical" id="alg_mod_dijkstra-2-4-2-1-2-2-1">
<div class="para">For each <span class="process-math">\(v\in V\setminus V'\)</span> such that <span class="process-math">\(uv\in E_f\text{,}\)</span> <span class="process-math">\(\dist{\Delta_f}{s}{u}+1\leq \dist{\Delta_f}{s}{v}\text{,}\)</span> and <span class="process-math">\(c_f(u,v)&gt;0\text{:}\)</span>
</div>
<ol class="lower-roman">
<li id="alg_mod_dijkstra-2-4-2-1-2-2-1-5-1"><div class="para" id="alg_mod_dijkstra-2-4-2-1-2-2-1-5-1-1">update the distance to <span class="process-math">\(v\)</span> by setting <span class="process-math">\(\dist{\Delta_f}{s}{v}=\dist{\Delta_f}{s}{u}+1\text{,}\)</span> and</div></li>
<li id="alg_mod_dijkstra-2-4-2-1-2-2-1-5-2"><div class="para" id="alg_mod_dijkstra-2-4-2-1-2-2-1-5-2-1">update the set of predecessors of <span class="process-math">\(v\text{,}\)</span> <span class="process-math">\(p(v)\text{,}\)</span> to include <span class="process-math">\(u\text{.}\)</span>
</div></li>
</ol>
</div></li>
<li id="alg_mod_dijkstra-2-4-2-1-2-3"><div class="para" id="alg_mod_dijkstra-2-4-2-1-2-3-1">Add <span class="process-math">\(u\)</span> to <span class="process-math">\(V'\text{.}\)</span>
</div></li>
</ol>
</div></li>
<li id="alg_mod_dijkstra-2-4-3"><div class="para" id="alg_mod_dijkstra-2-4-3-1">Return the values of <span class="process-math">\(\dist{\Delta_f}{s}{v}\)</span> and <span class="process-math">\(p(v)\)</span> for each <span class="process-math">\(v\in V\text{.}\)</span>
</div></li>
</ol>
</div></article><div class="para" id="sec-MaxFlow-DinitzAlgo-7">The true improvement of Dinitz’ algorithm over the earlier Ford-Fulkerson algorithm is not in its use of this shortest path algorithm once, but twice: if the output <span class="process-math">\(p(v)\)</span> is used to define a new set of arrows <span class="process-math">\(E_b=\set{uv:v\in p(u)}\)</span> we can use the modified shortest path algorithm now on the graph with edge set <span class="process-math">\(E_b\)</span> and source <span class="process-math">\(t\)</span> to ensure that the only shortest paths we retain are <span class="process-math">\(s,t\)</span>-paths.</div>
<article class="example example-like" id="exmp_capnet_1"><h4 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">6.4.5</span><span class="period">.</span><span class="space"> </span><span class="title">Applying Dinitz’ algorithm.</span>
</h4>
<figure class="figure figure-like" id="fig_capnet_1"><div class="image-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><img src="generated/latex-image/forwardflow.svg" role="img" class="contained"></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">6.4.6<span class="period">.</span></span><span class="space"> </span>(A) A capacitated network, <span class="process-math">\(\Delta=(V,E,c,v_1,v_5)\text{;}\)</span> (B) the result <span class="process-math">\(\Delta'\)</span> of applying <a href="" class="xref" data-knowl="./knowl/xref/alg_mod_dijkstra.html" title="Algorithm 6.4.4: Modified Dikstra: All Shortest Paths from s">Algorithm 6.4.4</a> on <span class="process-math">\(\Delta\text{;}\)</span> (C) the “layered graph” <span class="process-math">\(\Lambda=(V,E_\ell,c_\ell,v_1,v_5)\)</span> resulting from the application of <a href="" class="xref" data-knowl="./knowl/xref/alg_mod_dijkstra.html" title="Algorithm 6.4.4: Modified Dikstra: All Shortest Paths from s">Algorithm 6.4.4</a> on <span class="process-math">\(\Delta'\text{.}\)</span></figcaption></figure> <div class="para" id="exmp_capnet_1-2-2">The graph in (A) is a capacitated network <span class="process-math">\(\Delta=(V,E,c,s,t)\)</span> with <span class="process-math">\(V=\set{v_1,v_2,\ldots,v_6}\text{;}\)</span> only the indices of vertices are shown in the figure. Suppose we wish to apply Dijkstra’s algorithm to this graph rooted at <span class="process-math">\(v_1\text{.}\)</span> The neighbors of <span class="process-math">\(v_1\)</span> are <span class="process-math">\(N(v_1)=\set{v_2,v_3}\text{;}\)</span> visiting each of these in turn we see that the neighbors of <span class="process-math">\(v_2\)</span> are <span class="process-math">\(N(v_2)=\set{v_3,v_4,v_5}\text{;}\)</span> however, <span class="process-math">\(\dist{\Delta}{v_1}{v_3}=1\lt 2=\dist{\Delta}{v_1}{v_2}+1\text{,}\)</span> so we do not update the predecessors of <span class="process-math">\(v_3\text{.}\)</span> Likewise, <span class="process-math">\(N(v_3) = \set{v_4,v_5,v_6}\text{.}\)</span> As this provides new paths of the same length to both <span class="process-math">\(v_4\)</span> and <span class="process-math">\(v_5\text{,}\)</span> we add <span class="process-math">\(v_3\)</span> as a predecessor of each of those vertices.</div> <div class="para" id="exmp_capnet_1-2-3">Recalling that the modified Dijkstra’s algorithm provides a sort of “predecessor graph”, we have obtained the capacitated network shown in the figure as (B). The second step of producing the layered data structure is to apply Dijkstra’s algorithm on this intermediate graph, rooted now at the target vertex <span class="process-math">\(v_5\text{.}\)</span> As the graph is directed, we see that vertices <span class="process-math">\(v_4\)</span> and <span class="process-math">\(v_6\)</span> are unreachable in the intermediate graph when rooted at <span class="process-math">\(v_5\text{;}\)</span> hence the resulting layered graph of the figure labelled (C) has vertex <span class="process-math">\(v_1\)</span> at distance <span class="process-math">\(0\text{,}\)</span> vertices <span class="process-math">\(v_2\)</span> and <span class="process-math">\(v_3\)</span> at distance <span class="process-math">\(1\text{,}\)</span> and vertex <span class="process-math">\(v_5\)</span> at distance <span class="process-math">\(2\text{.}\)</span>
</div></article><div class="para" id="sec-MaxFlow-DinitzAlgo-9">It is important to make a note about the structure of <span class="process-math">\(\Lambda = (V,E_\ell,c_\ell,s,t)\)</span> produced from two successive applications of <a href="" class="xref" data-knowl="./knowl/xref/alg_mod_dijkstra.html" title="Algorithm 6.4.4: Modified Dikstra: All Shortest Paths from s">Algorithm 6.4.4</a>. We first produced <span class="process-math">\(\Delta'\)</span> from <span class="process-math">\(\Delta\)</span> by including the reverse edges of exactly those edges lying on shortest paths emanating from <span class="process-math">\(s\text{;}\)</span> we then construct <span class="process-math">\(\Lambda\)</span> from <span class="process-math">\(\Delta'\)</span> by including only those edges on shortest paths terminating at <span class="process-math">\(t\text{.}\)</span> Hence <em class="emphasis">every path in <span class="process-math">\(\Lambda\)</span> beginning at <span class="process-math">\(s\)</span> will terminate at <span class="process-math">\(t\)</span> and will be a shortest such path</em>. This structure must be maintained as we augment the flow across the network, for two reasons: as edges become saturated<details class="ptx-footnote" aria-live="polite" id="sec-MaxFlow-DinitzAlgo-9-10"><summary class="ptx-footnote__number" title="Footnote 4"><sup> 4 </sup></summary><div class="ptx-footnote__contents" id="sec-MaxFlow-DinitzAlgo-9-10">An edge <span class="process-math">\(uv\)</span> is <em class="emphasis">saturated</em> when <span class="process-math">\(f(u,v)=c(u,v)\text{,}\)</span> where <span class="process-math">\(f\)</span> is the flow and <span class="process-math">\(c\)</span> is the capacity.</div></details> they must be removed from the residual capacity graph, just as residual capacities of unsaturated edges must be decreased. When saturated edges are removed, this can result in a vertex with no successors or with no predecessors, and both of these types of vertex lie on no <span class="process-math">\(s,t\)</span>-path in <span class="process-math">\(\Lambda\text{.}\)</span>
</div>
<div class="para" id="sec-MaxFlow-DinitzAlgo-10">The graph <span class="process-math">\(\Lambda\)</span> is referred to as a layered structure since we can think of the vertices as lying in distance layers away from <span class="process-math">\(s\)</span> such that any edge <span class="process-math">\(uv\in E_\ell\)</span> has the property <span class="process-math">\(\dist{\Delta_f}{s}{v}=\dist{\Delta_f}{s}{u}+1\text{.}\)</span> Thus maintaining those layers means we need no special algorithm to find augmenting paths: any path emanating from <span class="process-math">\(s\)</span> in a well-maintained layered graph will eventually terminate at <span class="process-math">\(t\text{.}\)</span> The order in which paths are followed can change the final assignment of flow to edges, but interestingly cannot change the total final value of the flow. The flow assigned along the path is the minimum residual capacity along any edge of the path.</div>
<article class="algorithm theorem-like" id="alg_pathfind"><h4 class="heading">
<span class="type">Algorithm</span><span class="space"> </span><span class="codenumber">6.4.7</span><span class="period">.</span><span class="space"> </span><span class="title">Pathfinding.</span>
</h4>
<div class="para logical" id="alg_pathfind-2">
<div class="para">Suppose <span class="process-math">\(\Lambda = (V,E_\ell,c_\ell,s,t)\)</span> is the result of two applications of <a href="" class="xref" data-knowl="./knowl/xref/alg_mod_dijkstra.html" title="Algorithm 6.4.4: Modified Dikstra: All Shortest Paths from s">Algorithm 6.4.4</a> on a capacitated network <span class="process-math">\(\Delta=(V,E,c,s,t)\text{.}\)</span>
</div>
<ol class="decimal">
<li id="alg_pathfind-2-4-1"><div class="para" id="alg_pathfind-2-4-1-1">Let <span class="process-math">\(u_0=s\text{.}\)</span>
</div></li>
<li id="alg_pathfind-2-4-2"><div class="para" id="alg_pathfind-2-4-2-1">Inductively choose <span class="process-math">\(u_{i+1}\)</span> for <span class="process-math">\(i\geq 0\)</span> such that <span class="process-math">\(u_iu_{i+1}\in E_\ell\text{,}\)</span> until <span class="process-math">\(u_n=t\text{.}\)</span>
</div></li>
<li id="alg_pathfind-2-4-3"><div class="para" id="alg_pathfind-2-4-3-1">Let <span class="process-math">\(f^* = \min\set{c_\ell(u_i,u_{i+1}):i=1,2,\ldots,n-1}\text{.}\)</span>
</div></li>
<li id="alg_pathfind-2-4-4"><div class="para" id="alg_pathfind-2-4-4-1">The augmenting path to be returned is the path <span class="process-math">\((u_0,u_1,u_2,\ldots,u_n)\)</span> and the augmenting flow is <span class="process-math">\(f^*\)</span> on each of those edges.</div></li>
</ol>
</div></article><article class="example example-like" id="sec-MaxFlow-DinitzAlgo-12"><h4 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">6.4.8</span><span class="period">.</span><span class="space"> </span><span class="title">Continued from previous example..</span>
</h4>
<figure class="figure figure-like" id="sec-MaxFlow-DinitzAlgo-12-2-1"><div class="image-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><img src="generated/latex-image/backflow.svg" role="img" class="contained"></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">6.4.9<span class="period">.</span></span><span class="space"> </span>(A) An augmenting path with flow value <span class="process-math">\(f^*=8\)</span> in <span class="process-math">\(\Lambda\)</span> from <a href="" class="xref" data-knowl="./knowl/xref/exmp_capnet_1.html" title="Example 6.4.5: Applying Dinitz’ algorithm">Example 6.4.5</a>. (B) After updating the residual capacities of edges in <span class="process-math">\(E_\ell\text{,}\)</span> the edge <span class="process-math">\(v_2v_5\)</span> was saturated and therefore removed. This leaves <span class="process-math">\(v_2\)</span> with no successor vertices, so the edge <span class="process-math">\(v_1v_2\)</span> (shown with reduced capacity) must also be removed as no additional flow can move from <span class="process-math">\(v_1\)</span> to <span class="process-math">\(v_5\)</span> along <span class="process-math">\(v_1v_2\text{.}\)</span> (C) The graph <span class="process-math">\(\Lambda\)</span> after maintenance.</figcaption></figure> <div class="para" id="sec-MaxFlow-DinitzAlgo-12-2-2">In our graph <span class="process-math">\(\Lambda\text{,}\)</span> <span class="process-math">\(u_0=s=v_1\)</span> has only two successors: <span class="process-math">\(v_2\)</span> and <span class="process-math">\(v_3\text{.}\)</span> Choosing <span class="process-math">\(u_1=v_2\text{,}\)</span> we see that the only successor of <span class="process-math">\(u_1\)</span> in <span class="process-math">\(\Lambda\)</span> is <span class="process-math">\(v_5=t\text{,}\)</span> so <span class="process-math">\(u_2=v_5\text{.}\)</span> Our augmenting path is then <span class="process-math">\((v_1,v_2,v_5)\text{;}\)</span> as this flow only consists of two edges of capacities <span class="process-math">\(50\)</span> and <span class="process-math">\(8\)</span> respectively, it is clear that <span class="process-math">\(f^*=\min\set{50,8}=8\text{.}\)</span>
</div> <div class="para logical" id="sec-MaxFlow-DinitzAlgo-12-2-3">
<div class="para">The current flow in our graph is <span class="process-math">\(f(u,v)=0\)</span> for all <span class="process-math">\(uv\in E\text{,}\)</span> and we now have an augmenting path and flow. So we update the flow value to accommodate the augmentation:</div>
<div class="displaymath process-math">
\begin{equation*}
f(u,v) = \begin{cases}8, \amp  uv\in\set{v_1v_2,v_2v_5} \\ 0, \amp uv\in E\setminus\set{v_1v_2,v_2v_5}.
\end{cases}
\end{equation*}
</div>
</div> <div class="para" id="sec-MaxFlow-DinitzAlgo-12-2-4">We update our residual capacities and see that edge <span class="process-math">\(v_2v_5\)</span> is now saturated; removing this edge from <span class="process-math">\(E_\ell\)</span> we find that now <span class="process-math">\(v_2\)</span> has no successors and so all edges terminating at <span class="process-math">\(v_2\)</span> must also be removed in graph maintenance.</div> <div class="para logical" id="sec-MaxFlow-DinitzAlgo-12-2-5">
<div class="para">Having maintained the graph, we see that the path <span class="process-math">\((v_1,v_3,v_5)\)</span> remains and permits another augmenting flow of <span class="process-math">\(f^*=10\text{.}\)</span> Again updating, we have</div>
<div class="displaymath process-math">
\begin{equation*}
f(u,v) = \begin{cases}8, \amp  uv\in\set{v_1v_2,v_2v_5} \\
10, \amp  uv\in\set{v_1v_3,v_3v_5} \\
0, \amp uv\in E\setminus\set{v_1v_2,v_1v_3,v_2v_5,v_3v_5}.
\end{cases}
\end{equation*}
</div>
</div> <div class="para" id="sec-MaxFlow-DinitzAlgo-12-2-6">Now no augmenting flows remain in <span class="process-math">\(\Lambda\)</span> after maintenance, as <span class="process-math">\(v_1v_3\)</span> is saturated and hence <span class="process-math">\(v_3\)</span> has no predecessors in <span class="process-math">\(\Lambda\text{.}\)</span>
</div> <div class="para" id="sec-MaxFlow-DinitzAlgo-12-2-7">In order to continue to augment the flow, we must again determine the residual capacities and build a new residual graph <span class="process-math">\(\Delta_f\)</span> taking into account the current flow <span class="process-math">\(f\text{.}\)</span>
</div></article><article class="remark remark-like" id="sec-MaxFlow-DinitzAlgo-13"><h4 class="heading">
<span class="type">Remark</span><span class="space"> </span><span class="codenumber">6.4.10</span><span class="period">.</span>
</h4>
<div class="para" id="sec-MaxFlow-DinitzAlgo-13-1">About graph maintenance: there are several different ways that this can be handled, all with the same result but different in individual process. Dinitz originally kept track of the endpoints of edges which became saturated as the algorithm updated the residual capacities along an augmenting path. After these capacities were updated, the algorithm processed through lists of vertices which might have been left with either no successors or no predecessors. In our implementation, we opt for a recursive solution: when an edge <span class="process-math">\(uv\in E_\ell\)</span> becomes saturated, we call a process <em class="emphasis">Clean-to-source</em> on its head vertex <span class="process-math">\(u\)</span> and then a process <em class="emphasis">Clean-to-Target</em> on its tail vertex <span class="process-math">\(v\text{.}\)</span> These two processes behave similarly, but in opposite directions. The first, <em class="emphasis">Clean-to-source</em>, determines whether <span class="process-math">\(u\)</span> has any successors; if not, <em class="emphasis">Clean-to-source</em> is run on each predecessor <span class="process-math">\(w\)</span> of <span class="process-math">\(u\text{.}\)</span> Likewise <em class="emphasis">Clean-to-Target</em> checks whether <span class="process-math">\(v\)</span> has any predecessors, and if not, <em class="emphasis">Clean-to-Target</em> is run on each successor <span class="process-math">\(w\)</span> of <span class="process-math">\(v\text{.}\)</span>
</div></article><article class="algorithm theorem-like" id="alg_maint"><h4 class="heading">
<span class="type">Algorithm</span><span class="space"> </span><span class="codenumber">6.4.11</span><span class="period">.</span><span class="space"> </span><span class="title">Maintenance of layered graph.</span>
</h4>
<div class="para logical" id="alg_maint-2-1">
<div class="para">Suppose <span class="process-math">\(\Lambda = (V,E_\ell,c_\ell,s,t)\)</span> is the layered graph structure output from two successive applications of <a href="" class="xref" data-knowl="./knowl/xref/alg_mod_dijkstra.html" title="Algorithm 6.4.4: Modified Dikstra: All Shortest Paths from s">Algorithm 6.4.4</a>, that <span class="process-math">\(P=\set{s=u_0,u_1,\ldots,u_{n-1},u_n=t}\)</span> is an augmenting path with augmenting flow value <span class="process-math">\(f^*\text{.}\)</span>
</div>
<ol class="decimal">
<li id="alg_maint-2-1-5-1"><div class="para" id="alg_maint-2-1-5-1-1">For each <span class="process-math">\(i\in\set{0,1,2,\ldots,n-1}\text{,}\)</span> update <span class="process-math">\(c_\ell(u_i,u_{i+1})\)</span> by subtracting from it the value <span class="process-math">\(f^*\text{.}\)</span>
</div></li>
<li id="alg_maint-2-1-5-2"><div class="para logical" id="alg_maint-2-1-5-2-1">
<div class="para">For an edge <span class="process-math">\(uv\in E_\ell\)</span> where after updating, <span class="process-math">\(c_\ell(u,v)=0\text{,}\)</span> do the following:</div>
<ol class="lower-alpha">
<li id="alg_maint-2-1-5-2-1-3-1">
<span class="heading"><span class="title">Clean-to-source from a vertex <span class="process-math">\(u\)</span>.</span></span><div class="para logical" id="alg_maint-2-1-5-2-1-3-1-2"><ol class="lower-roman">
<li id="alg_maint-2-1-5-2-1-3-1-2-1-1"><div class="para logical" id="alg_maint-2-1-5-2-1-3-1-2-1-1-1">
<div class="para">The vertex <span class="process-math">\(u\)</span> has no successors in <span class="process-math">\(\Lambda\)</span> precisely when</div>
<div class="displaymath process-math">
\begin{equation*}
\set{w\in V: c_\ell(u,w)&gt;0}=\set{}.
\end{equation*}
</div>
</div></li>
<li id="alg_maint-2-1-5-2-1-3-1-2-1-2"><div class="para" id="alg_maint-2-1-5-2-1-3-1-2-1-2-1">If <span class="process-math">\(u\)</span> has no successors and is not the source vertex <span class="process-math">\(s\text{,}\)</span> consider the set <span class="process-math">\({P=\set{w\in V:c_\ell(w,u)&gt;0}}\)</span> of predecessors of <span class="process-math">\(u\text{.}\)</span>
</div></li>
<li id="alg_maint-2-1-5-2-1-3-1-2-1-3"><div class="para" id="alg_maint-2-1-5-2-1-3-1-2-1-3-1">For each <span class="process-math">\(w\in P\text{,}\)</span> set <span class="process-math">\(c_\ell(w,u)=0\text{.}\)</span> For each <span class="process-math">\(w\in P\)</span> with no successors other than <span class="process-math">\(u\text{,}\)</span> <em class="emphasis">clean-to-source from the vertex <span class="process-math">\(w\)</span></em>.</div></li>
</ol></div>
</li>
<li id="alg_maint-2-1-5-2-1-3-2">
<span class="heading"><span class="title">Clean-to-target from a vertex <span class="process-math">\(v\)</span>.</span></span><div class="para logical" id="alg_maint-2-1-5-2-1-3-2-2"><ol class="lower-roman">
<li id="alg_maint-2-1-5-2-1-3-2-2-1-1"><div class="para logical" id="alg_maint-2-1-5-2-1-3-2-2-1-1-1">
<div class="para">The vertex <span class="process-math">\(v\)</span> has no predecessors in <span class="process-math">\(\Lambda\)</span> precisely when</div>
<div class="displaymath process-math">
\begin{equation*}
\set{w\in V:c_\ell(w,v)&gt;0}=\set{}\text{.}
\end{equation*}
</div>
</div></li>
<li id="alg_maint-2-1-5-2-1-3-2-2-1-2"><div class="para" id="alg_maint-2-1-5-2-1-3-2-2-1-2-1">If <span class="process-math">\(v\)</span> has no sucessors and is not the target vertex <span class="process-math">\(t\text{,}\)</span> consider the set <span class="process-math">\(S=\set{w\in V:c_\ell(v,w)&gt;0}\)</span> of successors of <span class="process-math">\(v\text{.}\)</span>
</div></li>
<li id="alg_maint-2-1-5-2-1-3-2-2-1-3"><div class="para" id="alg_maint-2-1-5-2-1-3-2-2-1-3-1">For each <span class="process-math">\(w\in S\text{,}\)</span> set <span class="process-math">\(c_\ell(v,w)=0\text{.}\)</span> For each <span class="process-math">\(w\in S\)</span> with no predecessors other than <span class="process-math">\(v\text{,}\)</span> <em class="emphasis">clean-to-target from the vertex <span class="process-math">\(w\)</span></em>.</div></li>
</ol></div>
</li>
</ol>
</div></li>
<li id="alg_maint-2-1-5-3"><div class="para" id="alg_maint-2-1-5-3-1">After both cleaning processes have finished for all saturated edges, remove from <span class="process-math">\(E_\ell\)</span> any edge <span class="process-math">\(uv\)</span> with <span class="process-math">\(c_\ell(u,v)=0\text{.}\)</span>
</div></li>
</ol>
</div></article><div class="para" id="sec-MaxFlow-DinitzAlgo-15">We now have all the pieces in place to actually state Dinitz’ algorithm.</div>
<article class="algorithm theorem-like" id="sec-MaxFlow-DinitzAlgo-16"><h4 class="heading">
<span class="type">Algorithm</span><span class="space"> </span><span class="codenumber">6.4.12</span><span class="period">.</span><span class="space"> </span><span class="title">Dinitz’ Max Flow Algorithm.</span>
</h4>
<div class="para logical" id="sec-MaxFlow-DinitzAlgo-16-2-1">
<div class="para">Suppose we are given a capacitated network <span class="process-math">\(\Delta = (V,E,c,s,t)\)</span> with capacity function <span class="process-math">\(c:E\to\Reals^+\text{,}\)</span> source <span class="process-math">\(s\text{,}\)</span> and target <span class="process-math">\(t\text{.}\)</span>
</div>
<ol class="decimal">
<li id="sec-MaxFlow-DinitzAlgo-16-2-1-5-1"><div class="para" id="sec-MaxFlow-DinitzAlgo-16-2-1-5-1-1">Define the initial flow <span class="process-math">\(f(u,v)=0\)</span> for <span class="process-math">\(uv\in E\)</span> or <span class="process-math">\(vu\in E\text{.}\)</span>
</div></li>
<li id="sec-MaxFlow-DinitzAlgo-16-2-1-5-2"><div class="para logical" id="sec-MaxFlow-DinitzAlgo-16-2-1-5-2-1">
<div class="para">Repeat the following:</div>
<ol class="lower-alpha">
<li id="sec-MaxFlow-DinitzAlgo-16-2-1-5-2-1-1-1"><div class="para logical" id="sec-MaxFlow-DinitzAlgo-16-2-1-5-2-1-1-1-1">
<div class="para">Calculate the <em class="emphasis">residual capacity function</em> <span class="process-math">\(c_f:V\times V\to \Reals^+\text{,}\)</span> given by:</div>
<div class="displaymath process-math">
\begin{equation*}
c_f(u,v) = \begin{cases}c(u,v) - f(u,v), \amp  uv\in E \\
f(u,v), \amp  vu\in E
\end{cases} .
\end{equation*}
</div>
<div class="para">We remark that a positive flow of <span class="process-math">\(f(u,v)\)</span> provides exactly that much capacity to the reverse edge <span class="process-math">\(vu\text{.}\)</span>
</div>
</div></li>
<li id="sec-MaxFlow-DinitzAlgo-16-2-1-5-2-1-1-2"><div class="para logical" id="sec-MaxFlow-DinitzAlgo-16-2-1-5-2-1-1-2-1">
<div class="para">Let <span class="process-math">\(\Delta_f=(V,E_f,c_f,s,t)\)</span> be the <em class="emphasis">residual graph</em> with</div>
<div class="displaymath process-math">
\begin{equation*}
E_f=\set{uv\in E:c_f(u,v)&gt;0}.
\end{equation*}
</div>
</div></li>
<li id="sec-MaxFlow-DinitzAlgo-16-2-1-5-2-1-1-3"><div class="para" id="sec-MaxFlow-DinitzAlgo-16-2-1-5-2-1-1-3-1">Apply <a href="" class="xref" data-knowl="./knowl/xref/alg_mod_dijkstra.html" title="Algorithm 6.4.4: Modified Dikstra: All Shortest Paths from s">Algorithm 6.4.4</a> to <span class="process-math">\(\Delta\)</span> to produce <span class="process-math">\(\Delta'\text{;}\)</span> apply <a href="" class="xref" data-knowl="./knowl/xref/alg_mod_dijkstra.html" title="Algorithm 6.4.4: Modified Dikstra: All Shortest Paths from s">Algorithm 6.4.4</a> again to <span class="process-math">\(\Delta'\)</span> to obtain the layered graph <span class="process-math">\(\Lambda = (V,E_\ell,c_\ell,s,t)\text{.}\)</span> <em class="emphasis">When no shortest paths from <span class="process-math">\(s\)</span> to <span class="process-math">\(t\)</span> are found in constructing <span class="process-math">\(\Delta'\text{,}\)</span> the flow is optimal.</em>
</div></li>
<li id="sec-MaxFlow-DinitzAlgo-16-2-1-5-2-1-1-4"><div class="para logical" id="sec-MaxFlow-DinitzAlgo-16-2-1-5-2-1-1-4-1">
<div class="para">Repeat the following:</div>
<ol class="lower-roman">
<li id="sec-MaxFlow-DinitzAlgo-16-2-1-5-2-1-1-4-1-1-1"><div class="para" id="sec-MaxFlow-DinitzAlgo-16-2-1-5-2-1-1-4-1-1-1-1">Use <a href="" class="xref" data-knowl="./knowl/xref/alg_pathfind.html" title="Algorithm 6.4.7: Pathfinding">Algorithm 6.4.7</a> to find an augmenting path <span class="process-math">\(P\)</span> with flow value <span class="process-math">\(f^*\)</span> in <span class="process-math">\(\Lambda\text{.}\)</span> If no augmenting path exists, return to step a.</div></li>
<li id="sec-MaxFlow-DinitzAlgo-16-2-1-5-2-1-1-4-1-1-2"><div class="para" id="sec-MaxFlow-DinitzAlgo-16-2-1-5-2-1-1-4-1-1-2-1">Update <span class="process-math">\(f\)</span> by adding <span class="process-math">\(f^*\)</span> to the flow for each edge <span class="process-math">\(u_iu_{i+1}\)</span> where <span class="process-math">\(u_i,u_{i+1}\)</span> are adjacent vertices in <span class="process-math">\(P\text{.}\)</span>
</div></li>
<li id="sec-MaxFlow-DinitzAlgo-16-2-1-5-2-1-1-4-1-1-3"><div class="para" id="sec-MaxFlow-DinitzAlgo-16-2-1-5-2-1-1-4-1-1-3-1">Perform <a href="" class="xref" data-knowl="./knowl/xref/alg_maint.html" title="Algorithm 6.4.11: Maintenance of layered graph">Algorithm 6.4.11</a> upon <span class="process-math">\(\Lambda\text{.}\)</span>
</div></li>
</ol>
</div></li>
</ol>
</div></li>
</ol>
</div></article></section><section class="subsection" id="sec-MaxFlow-DinitzImpl"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">6.4.3</span><span class="space"> </span><span class="title">Implementing Dinitz’ Algorithm</span>
</h3>
<div class="para" id="sec-MaxFlow-DinitzImpl-2">There are a number of algorithms which need to be separately implemented as functions in order for the Dinitz Maximum Flow algorithm to operate.</div>
<figure class="listing figure-like" id="list-dinitz_all_shortest_paths"><div class="code-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><pre class="program"><code class="language-py">def all_shortest_paths(vertex_set, warrows, source):
    # Note: float('inf') represents Infinity.
    unvisited_distance = [(0,source)]
    unvisited_distance += [(float('inf'), v) for v in vertex_set if v!=source]
    distance = {v:d for d,v in unvisited_distance}
    predecessor = {v:[] for v in vertex_set}
    visited = [ ]
    while len(visited) &lt; len(vertex_set):
        # find nearest unvisited vertex
        unvisited_distance.sort()
        du, u = unvisited_distance.pop(0)
        for v, cap_uv in warrows[u].items():
            if v in visited: continue
            elif (du + 1 &lt;= distance[v]) and (cap_uv &gt; 0):
                unvisited_distance.remove( (distance[v], v) )
                distance[v] = du + 1
                if u not in predecessor[v]:
                    predecessor[v].append( u )
                unvisited_distance.append( (distance[v], v) )
        visited.append( u )
    return predecessor
</code></pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">6.4.13<span class="period">.</span></span><span class="space"> </span>Implementation of <a href="" class="xref" data-knowl="./knowl/xref/alg_mod_dijkstra.html" title="Algorithm 6.4.4: Modified Dikstra: All Shortest Paths from s">Algorithm 6.4.4</a> returning the lists of predecessors of each vertex.</figcaption></figure><figure class="listing figure-like" id="list-dinitz_predecessors_to_backarrows"><div class="code-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><pre class="program"><code class="language-py">def build_back_arrows(vertex_set, warrows, predecessors):
    back_arrows = {v:{} for v in vertex_set}
    for u,pu in predecessors.items():
        for v in pu:
            try:
                back_arrows[u][v] = warrows[v][u]
            except KeyError:
                back_arrows[u] = {v:warrows[v][u]}
    return back_arrows
</code></pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">6.4.14<span class="period">.</span></span><span class="space"> </span>A function which takes a dictionary of lists of predecessor vertices and a dictionary of arrows of a directed graph and returns the reversed arrows corresponding to the given predecessor relationships.</figcaption></figure><figure class="listing figure-like" id="list-dinitz_pathfinding"><div class="code-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><pre class="program"><code class="language-py">def pathfinding(warrows:dict, source, target):
    augpath = [source]
    augflow = float('inf')
    while augpath[-1] != target:
        neighbors = list(warrows[augpath[-1]].items())
        next_vert, next_cap = neighbors[0]
        if next_cap &lt; augflow:
            augflow = next_cap
        augpath.append(next_vert)
    return augpath, augflow
</code></pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">6.4.15<span class="period">.</span></span><span class="space"> </span>Implementation of <a href="" class="xref" data-knowl="./knowl/xref/alg_pathfind.html" title="Algorithm 6.4.7: Pathfinding">Algorithm 6.4.7</a></figcaption></figure><figure class="listing figure-like" id="list-dinitz_preds_succs"><div class="code-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><pre class="program"><code class="language-py">def predecessors(warrows:dict, vertex):
    return [w for w,nbrs in warrows.items() if vertex in nbrs.keys() and warrows[w][vertex] &gt; 0 ]

def successors(warrows:dict, vertex):
    return [w for w,c in warrows[vertex].items() if c&gt;0]
</code></pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">6.4.16<span class="period">.</span></span><span class="space"> </span>Predecessor and successor functions for layered graph maintenance in Dinitz’ algorithm</figcaption></figure><figure class="listing figure-like" id="list-dinitz_cleaning_functions"><div class="code-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><pre class="program"><code class="language-py">def clean_to_source(layered_cap, vertex, source):
    if vertex!=source and len(successors(layered_cap, vertex)) == 0:
        for w in predecessors(layered_cap, vertex):
            layered_cap[w][vertex] = 0
            if len(successors(layered_cap, w))==0:
                layered_cap = clean_to_source(layered_cap, w, source)
    return layered_cap

def clean_to_target(layered_cap, vertex, target):
    if vertex!=target and len(predecessors(layered_cap, vertex))==0:
        for w in successors(layered_cap, vertex):
            layered_cap[vertex][w] = 0
            if predecessors(layered_cap, w) in ([vertex], []):
                layered_cap = clean_to_target(layered_cap, w, target)
    return layered_cap
</code></pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">6.4.17<span class="period">.</span></span><span class="space"> </span>Cleaning functions for layered graph maintenance in Dinitz’ algorithm</figcaption></figure><figure class="listing figure-like" id="list-dinitz_maintenance"><div class="code-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><pre class="program"><code class="language-py">def maintain_layers(layered_cap, aug_path, aug_flow, source, target):
    pairs = zip(aug_path[:-1], aug_path[1:])
    for u,v in pairs:
        layered_cap[u][v] -= aug_flow
        if layered_cap[u][v] == 0:
            layered_cap = clean_to_source(layered_cap, u, source)
            layered_cap = clean_to_target(layered_cap, v, target)
    pruners = []
    for u,nbrs in layered_cap.copy().items():
        for v,c in nbrs.items():
            if c==0:
                pruners.append( (u,v) )
    for u,v in pruners:
        del layered_cap[u][v]
    return layered_cap
</code></pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">6.4.18<span class="period">.</span></span><span class="space"> </span>Layered graph maintenance in Dinitz’ algorithm</figcaption></figure><figure class="listing figure-like" id="list-dinitz"><div class="code-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><pre class="program"><code class="language-py">def dinitz(vertex_set, capacity, source, target, debug=False):
    cap_edges = [(u,v,c) for u,out_arrows in capacity.items() for v,c in out_arrows.items()]
    # Initialize Zero Flow
    total_flow = 0
    flow = {u:{v:0 for v in out_arrows.keys()} for u,out_arrows in capacity.items()}
    for u,v,c in cap_edges:
        try:
            flow[v][u] = 0
        except:
            flow[v] = {u:0}
    while True:
        # Create residual capacity
        res_capacity = {u:{v:c-flow[u][v] for v,c in out_arrows.items()} for u,out_arrows in capacity.items()}
        for u,v,c in cap_edges:
            try:
                res_capacity[v][u] = flow[u][v]
            except KeyError:
                res_capacity[v] = {u:flow[u][v]}

        res_capacity = {u:{v:c for v,c in out_arrows.items() if c&gt;0} for u,out_arrows in res_capacity.items()}
        if debug: print(f"Residual Capacities computed:\n{res_capacity}")
        # Create layered graph
        pred = all_shortest_paths(vertex_set, res_capacity, source)
        back_cap = build_back_arrows(vertex_set, res_capacity, pred)
        pred = all_shortest_paths(vertex_set, back_cap, target)
        layered_capacity = build_back_arrows(vertex_set, back_cap, pred)
        if debug: print(f"Layered Graph computed:\n{layered_capacity}")
        if layered_capacity[source] == {}:
            print(f"Maximum flow of {total_flow} achieved.")
            break
        try:
            # Repeatedly find augmenting paths
            while True:
                ap, af = pathfinding(layered_capacity, source, target)
                if debug: print(f"Augmenting path {ap} of capacity {af} found.")
                total_flow += af
                for u,v in zip(ap[:-1],ap[1:]):
                    flow[u][v] += af
                layered_capacity = maintain_layers(layered_capacity, ap, af, source, target)
                if debug: print(f"After maintenance, layered graph is:\n{layered_capacity}")
        except:
            if debug: print(f"No more augmenting paths.")
            continue
    # prune empty flows
    flow = {u:{v:f for v,f in flow_arrows.items() if f&gt;0} for u,flow_arrows in flow.items()}
    return flow
</code></pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">6.4.19<span class="period">.</span></span><span class="space"> </span>Dinitz algorithm implemented in Python</figcaption></figure><div class="para" id="sec-MaxFlow-DinitzImpl-10">Once you have all that code implemented, you can test it using a simple program.</div>
<div class="code-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><pre class="program"><code class="language-py">verts = range(6)
cap = {0:{1:50, 2:10}, 1:{2:10, 3:5, 4: 8}, 2:{1:20, 3:10, 5:20, 4:20}, 3:{4:13}, 4:{}, 5:{4:20}}
s = 0
t = 4

print(dinitz(verts, cap, 0, 4, True))
</code></pre></div></section></section></div>
<div class="ptx-content-footer">
<a class="previous-button button" href="sec-gtalgos-shortestpath.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="top-button button" href="#" title="Top"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Top</span></a><a class="next-button button" href="aam-backmatter.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a>
</div></main>
</div>
<div id="ptx-page-footer" class="ptx-page-footer">
<a class="pretext-link" href="https://pretextbook.org" title="PreTeXt"><div class="logo"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="338 3000 8772 6866"><g style="stroke-width:.025in; stroke:black; fill:none"><polyline points="472,3590 472,9732 " style="stroke:#000000;stroke-width:174; stroke-linejoin:miter; stroke-linecap:round; "></polyline><path style="stroke:#000000;stroke-width:126;stroke-linecap:butt;" d="M 4724,9448 A 4660 4660  0  0  1  8598  9259"></path><path style="stroke:#000000;stroke-width:174;stroke-linecap:butt;" d="M 4488,9685 A 4228 4228  0  0  0   472  9732"></path><path style="stroke:#000000;stroke-width:126;stroke-linecap:butt;" d="M 4724,3590 A 4241 4241  0  0  1  8598  3496"></path><path style="stroke:#000000;stroke-width:126;stroke-linecap:round;" d="M 850,3496  A 4241 4241  0  0  1  4724  3590"></path><path style="stroke:#000000;stroke-width:126;stroke-linecap:round;" d="M 850,9259  A 4507 4507  0  0  1  4724  9448"></path><polyline points="5385,4299 4062,8125" style="stroke:#000000;stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8598,3496 8598,9259" style="stroke:#000000;stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="850,3496 850,9259" style="stroke:#000000;stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="4960,9685 4488,9685" style="stroke:#000000;stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="3070,4582 1889,6141 3070,7700" style="stroke:#000000;stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="6418,4582 7600,6141 6418,7700" style="stroke:#000000;stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8976,3590 8976,9732" style="stroke:#000000;stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><path style="stroke:#000000;stroke-width:174;stroke-linecap:butt;" d="M 4960,9685 A 4228 4228  0  0  1  8976  9732"></path></g></svg></div></a><a class="runestone-link" href="https://runestone.academy" title="Runestone Academy"><img class="logo" src="https://runestone.academy/runestone/static/images/RAIcon_cropped.png"></a><a class="mathjax-link" href="https://www.mathjax.org" title="MathJax"><img class="logo" src="https://www.mathjax.org/badge/badge-square-2.png"></a>
</div>
</body>
</html>
