<!DOCTYPE html>
<html lang="en-US">
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="noindex, nofollow">
</head>
<body class="ignore-math">
<article class="activity project-like"><h4 class="heading">
<span class="type">Activity</span><span class="space"> </span><span class="codenumber">3.2</span><span class="period">.</span><span class="space"> </span><span class="title">DIANA: Vigenère-style encryption.</span>
</h4>
<div class="introduction"><div class="para logical">
<div class="para">Implementation of the Vigenère cipher is suprisingly easy; we'll implement a slightly modified version called the DIANA cipher, used by the National Security Agency. The difference between the two is that the tabular rasa of the Vigenère cipher includes the identity permutation as the first column of the table, where in the DIANA system no letter of the key is represented by an identity permutation. The matrix of the DIANA cipher is as follows, in both alphabetix and arithmetic forms:</div>
<div class="displaymath process-math">
\begin{align*}
\small
\begin{array}{c|cccccccc}
\amp A \amp B \amp C \amp D \amp \cdots \amp Y \amp Z \\ \hline
A \amp      Z \amp      Y \amp      X \amp      W \amp \cdots \amp      B \amp      A \\
B \amp      Y \amp      X \amp      W \amp      V \amp \cdots \amp      A \amp      Z \\
C \amp      X \amp      W \amp      V \amp      U \amp \cdots \amp      Z \amp      Y \\
D \amp      W \amp      V \amp      U \amp      T \amp \cdots \amp      Y \amp      X \\
\vdots \amp \vdots \amp \vdots \amp \vdots \amp \vdots \amp \ddots \amp \vdots \amp \vdots \\
Y \amp      B \amp      A \amp      Z \amp      Y \amp \cdots \amp      D \amp      C \\
Z \amp      A \amp      Z \amp      Y \amp      X \amp \cdots \amp      C \amp      B
\end{array} \amp\qquad
\small
\begin{array}{c|cccccccc}
~ \amp  0 \amp  1 \amp  2 \amp  3 \amp \cdots \amp 24 \amp 25 \\ \hline
0 \amp 25 \amp 24 \amp 23 \amp 22 \amp \cdots \amp  1 \amp  0 \\
1 \amp 24 \amp 23 \amp 22 \amp 21 \amp \cdots \amp  0 \amp 25 \\
2 \amp 23 \amp 22 \amp 21 \amp 20 \amp \cdots \amp 25 \amp 24 \\
3 \amp 22 \amp 21 \amp 20 \amp 19 \amp \cdots \amp 24 \amp 23 \\
\vdots \amp \vdots \amp \vdots \amp \vdots \amp \vdots \amp \ddots \amp \vdots \amp \vdots \\
24 \amp  1 \amp  0 \amp 25 \amp 24 \amp \cdots \amp  3 \amp  2 \\
25 \amp  0 \amp 25 \amp 24 \amp 23 \amp \cdots \amp  2 \amp  1
\end{array}
\end{align*}
</div>
</div></div>
<article class="task exercise-like"><h5 class="heading"><span class="codenumber">(a)</span></h5>
<div class="para">Use a <dfn class="terminology">nested for loop</dfn> to create a list-of-lists containing the DIANA cipher. You'll need to create a mathematical formula (involving remainders!) for the element of the <span class="process-math">\(m\)</span>th row and <span class="process-math">\(k\)</span>th column of the DIANA matrix, where <span class="process-math">\(k,m\in\set{0,\dotsc,25}\text{.}\)</span>
</div>
<div class="code-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><pre class="program"><code class="language-py">diana = [ ]
for m in range( 26 ):
    new_row = [ ]
    for k in range( 26 ):
        # CHANGE THIS to the correct value involving k and m
        new_row.append( 0 )
    diana.append( new_row )
print( diana )
</code></pre></div></article><article class="task exercise-like"><h5 class="heading"><span class="codenumber">(b)</span></h5>
<div class="introduction">
<div class="para">Remember that <code class="code-inline tex2jax_ignore">ord('A')</code> is 65, so to find the alphabet index of a capital letter stored as a string <code class="code-inline tex2jax_ignore">x</code> would require using <code class="code-inline tex2jax_ignore">ord(x)-65</code>. If we write <span class="process-math">\([D]_{i,j}\)</span> to mean the entry in the <span class="process-math">\(i\)</span>th row and <span class="process-math">\(j\)</span>th column of the numerical DIANA matrix given above, then we now have from task (a) a mathematical formula for the value of <span class="process-math">\([D]_{i,j}\text{.}\)</span> Since that value is the encrypted value of a message character with index <code class="code-inline tex2jax_ignore">i</code> using key character <code class="code-inline tex2jax_ignore">j</code>, we can build a DIANA cipher!</div> <div class="para">The first step to applying the DIANA cipher given a cryptographic key <code class="code-inline tex2jax_ignore">key</code> and a message <code class="code-inline tex2jax_ignore">msg</code> is to ensure that both message and key consist only of capital letters, and that the cryptographic key is either already as long as the message or has been extended by repetition to be at least as long as the message. Then the key and message can be converted to lists of integers, which then can be processed through the DIANA cipher. In order to decrypt a message, we must acknowledge that the DIANA cipher is that it is an <dfn class="terminology">involution</dfn>: <span class="process-math">\(k=[D]_{i,j}\)</span> if and only if <span class="process-math">\(i=[D]_{k,j}\text{.}\)</span>
</div>
</div>
<article class="task exercise-like"><h6 class="heading"><span class="codenumber">(i)</span></h6>
<div class="para">Write a detailed step-by-step algorithm on paper to explain the DIANA cipher.</div></article><article class="task exercise-like"><h6 class="heading"><span class="codenumber">(ii)</span></h6>
<div class="para">Create a function <code class="code-inline tex2jax_ignore">diana(key, msg)</code> which performs the DIANA cipher using an input string <code class="code-inline tex2jax_ignore">key</code> to encrypt and decrypt a message string <code class="code-inline tex2jax_ignore">msg</code>, which works correctly whether <code class="code-inline tex2jax_ignore">msg</code> is plaintext or ciphertext.</div></article></article></article><span class="incontext"><a href="sec-crypto-proj.html#proj-crypto-digitizing_viginere" class="internal">in-context</a></span>
</body>
</html>
