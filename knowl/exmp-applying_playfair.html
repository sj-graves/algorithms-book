<!DOCTYPE html>
<html lang="en-US">
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="noindex, nofollow">
</head>
<body class="ignore-math">
<article class="example example-like"><h4 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">3.2.2</span><span class="period">.</span><span class="space"> </span><span class="title">Applying Playfair's cipher.</span>
</h4>  <div class="para">To perform Playfair's cipher, the first step is to generate a shared secret, called the <dfn class="terminology">key phrase</dfn>. This can be any memorable phrase in the target alphabet. For instance, we could choose the phrase “Go Patriots! Talons up!” in an excess of school spirit. Next we have to clean up the passphrase, which takes a few steps. First, convert all alphabetic characters to capitals, throw away all non-alphabetic characters, and append the alphabet <span class="process-math">\(\mathcal{E}\)</span> to the end of the key phrase. For our example, that would give us</div> <div class="code-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><pre class="program"><code class="language-none">GOPATRIOTSTALONSUPABCDEFGHIJKLMNOPQRSTUVWXYZ
</code></pre></div> <div class="para">Next, replace all <code class="code-inline tex2jax_ignore">I</code> characters with <code class="code-inline tex2jax_ignore">J</code> characters. This is necessary as the algorithm relies on a 25-letter alphabet, and since <code class="code-inline tex2jax_ignore">J</code> looks similar to <code class="code-inline tex2jax_ignore">I</code> but is an uncommon letter we merge all the <code class="code-inline tex2jax_ignore">I</code> and <code class="code-inline tex2jax_ignore">J</code> characters together. Then remove all multiple instances of a letter. This process applied to our key phrase results in a pre-processed key phrase of</div> <div class="code-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><pre class="program"><code class="language-none">GOPATRJSLNUBCDEFHKMQVWXYZ
</code></pre></div>  <div class="para">Now we write the <dfn class="terminology">Playfair grid</dfn>. In a <span class="process-math">\(5\times 5\)</span> grid, starting in the top left, write the letters of the pre-processed key phrase. For our key phrase, this produces the following:</div> <figure class="figure figure-like"><div class="image-box" style="width: 30%; margin-left: 35%; margin-right: 35%;"><img src="generated/latex-image/img-playfair_grid.svg" role="img" class="contained"></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">3.2.3<span class="period">.</span></span><span class="space"> </span>Playfair grid for the key phrase “Go Patriots! Talons up!”</figcaption></figure> <div class="para">The grid provides the permutation of digraphs in a rather clever way, and it's a <dfn class="terminology">symmetric key</dfn>, meaning that the same key (the grid itself) is used to encrypt messages as is used to decrypt ciphertexts. As a message, suppose we want to encrypt the ridiculous message “The bookkeeper remains sequestered. The suq question remains bizarre. Tax Xavier.” This message is chosen because it has many double letters, which have to be treated carefully in another pre-processing step.</div> <div class="para">Convert the message to capitals, then replace all <code class="code-inline tex2jax_ignore">I</code> characters with <code class="code-inline tex2jax_ignore">J</code>. We begin breaking our message into two-letter pairs called <dfn class="terminology">digraphs</dfn>, but we never want a digraph to contain the same letter twice. When that happens, we will insert an <code class="code-inline tex2jax_ignore">X</code> between the two letters, unless the letters are both <code class="code-inline tex2jax_ignore">X</code>; in that case, insert a <code class="code-inline tex2jax_ignore">Q</code>. This turns our message into the following:</div> <div class="code-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><pre class="program"><code class="language-none">TH EB OX OK KE EP ER RE MA JN SX SE
QU ES TE RE DT HE SU QX QU ES TJ ON
RE MA JN SB JZ AR RE TA XQ XA VJ ER
</code></pre></div>  <div class="para">To encrypt this processed message, we work one digraph at a time, drawing a box in the Playfair grid around each pair of letters. For the digraph <code class="code-inline tex2jax_ignore">TH</code> in our grid, that looks like this:</div> <figure class="figure figure-like"><div class="image-box" style="width: 30%; margin-left: 35%; margin-right: 35%;"><img src="generated/latex-image/img-playfair-boxed.svg" role="img" class="contained"></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">3.2.4<span class="period">.</span></span><span class="space"> </span>Playfair grid for the key phrase “Go Patriots! Talons up!” with the digraph <code class="code-inline tex2jax_ignore">TH</code> boxed in red, <code class="code-inline tex2jax_ignore">EB</code> boxed in blue, and <code class="code-inline tex2jax_ignore">MA</code> boxed in green.</figcaption></figure> <div class="para">With the digraph boxed, there are three possible next steps.</div> <div class="para logical"><ul class="disc">
<li><div class="para">
<em class="emphasis">Normal:</em> If the box intersects more than one row and more than one column, then letters in the corners of the box are used to replace the digraph. The upper left letter replaces the upper right letter (and vice versa) and the lower left letter replaces the lower right letter (and vice versa). In <a href="" class="xref" data-knowl="./knowl/fig-playfair-boxed.html" title="Figure 3.2.4">Figure 3.2.4</a> this will result in the digraph <code class="code-inline tex2jax_ignore">TH</code> mapping to <code class="code-inline tex2jax_ignore">OQ</code>.</div></li>
<li><div class="para">
<em class="emphasis">Right shift</em>: If the box is all on one line in the grid, the box shifts one unit to the right, wrapping around the grid if necessary. The left letter of the old box is now replaced by the left letter of the new box, while the right letter of the old box is now replaced by the right letter of the new box. In <a href="" class="xref" data-knowl="./knowl/fig-playfair-boxed.html" title="Figure 3.2.4">Figure 3.2.4</a> this will result in the digraph <code class="code-inline tex2jax_ignore">EB</code> being replaced by <code class="code-inline tex2jax_ignore">UC</code>.</div></li>
<li><div class="para">
<em class="emphasis">Down shift</em>: If the box is all on one column of the grid, the box shifts one unit down, and the similar process is followed as when the letters were in the same row. In <a href="" class="xref" data-knowl="./knowl/fig-playfair-boxed.html" title="Figure 3.2.4">Figure 3.2.4</a> this will result in the digraph <code class="code-inline tex2jax_ignore">MA</code> being replaced by <code class="code-inline tex2jax_ignore">YL</code>.</div></li>
</ul></div> <div class="para">Following these steps for each digraph, we obtain the following result, where the input digraph appears on the row above the output digraph.</div> <div class="code-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><pre class="console">TH EB OX OK KE EP ER RE MA JN SX SE QU ES TE RE DT HE
OQ UC PW PH QC CT UN NU YL SR CP NC FE CN NQ NU EA QB
SU QX QU ES TJ ON RE MA JN SB JZ AR RE TA XQ XA VJ ER
RC KZ FE CN ON TJ NU YL SR JC NW GL NU GT ZK YP WR UN
</pre></div> <div class="para">Frequently the ciphertext will be displayed in blocks of a fixed number of characters. Using an odd block size might incline a spy to think that Playfair's cipher was not being used! To reverse Playfair's cipher and decrypt our blocked ciphertext</div> <div class="code-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><pre class="program"><code class="language-none">OQUCPWPHQ CCTUNNUYL SRCPNCFEC NNQNUEAQB
RCKZFECNO NTJNUYLSR JCNWGLNUG TZKYPWRUN
</code></pre></div> <div class="para">we simply feed the ciphertext back into the same grid, but this time use a left shift instead of right shift and an up shift instead of a down shift.</div></article><span class="incontext"><a href="sec-crypto-classic.html#exmp-applying_playfair" class="internal">in-context</a></span>
</body>
</html>
